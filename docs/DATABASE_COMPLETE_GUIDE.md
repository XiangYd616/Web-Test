# å®Œå¤‡çš„æ•°æ®åº“ç®¡ç†æŒ‡å—

## ğŸ¯ æ¦‚è¿°

Test Web App ä½¿ç”¨ PostgreSQL ä½œä¸ºä¸»æ•°æ®åº“ï¼Œé‡‡ç”¨**ä¼ä¸šçº§å®Œå¤‡æ¶æ„è®¾è®¡**ï¼Œæ”¯æŒACIDäº‹åŠ¡ã€å¤æ‚æŸ¥è¯¢å’Œæ•°æ®å®Œæ•´æ€§çº¦æŸã€‚æ•°æ®åº“è®¾è®¡éµå¾ªç¬¬ä¸‰èŒƒå¼ï¼Œç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ã€‚

## ğŸ—ï¸ å®Œå¤‡æ•°æ®åº“æ¶æ„ v3.0

### ğŸ“Š æ¶æ„ç»Ÿè®¡
- **37ä¸ªä¸šåŠ¡è¡¨** - å®Œæ•´çš„ä¼ä¸šçº§æ¶æ„
- **135ä¸ªä¼˜åŒ–ç´¢å¼•** - é«˜æ€§èƒ½æŸ¥è¯¢æ”¯æŒ
- **19ä¸ªè§¦å‘å™¨** - è‡ªåŠ¨åŒ–ä¸šåŠ¡é€»è¾‘
- **3ä¸ªè§†å›¾** - æ•°æ®æ±‡æ€»å’Œç»Ÿè®¡
- **5ä¸ªå­˜å‚¨å‡½æ•°** - å¤æ‚ä¸šåŠ¡é€»è¾‘
- **50+ä¸ªçº¦æŸ** - æ•°æ®å®Œæ•´æ€§ä¿éšœ

### ğŸ—ï¸ æ ¸å¿ƒæ¨¡å—æ¶æ„

#### 1. ç”¨æˆ·ç®¡ç†æ¨¡å— (8ä¸ªè¡¨)
- `users` - ç”¨æˆ·ä¸»è¡¨ (å®Œæ•´çš„ç”¨æˆ·ä¿¡æ¯ã€è§’è‰²ã€çŠ¶æ€)
- `user_sessions` - ç”¨æˆ·ä¼šè¯ç®¡ç†
- `refresh_tokens` - åˆ·æ–°ä»¤ç‰Œç®¡ç†
- `user_preferences` - ç”¨æˆ·åå¥½è®¾ç½®
- `user_activity_logs` - ç”¨æˆ·æ´»åŠ¨æ—¥å¿—
- `user_bookmarks` - ç”¨æˆ·æ”¶è—ç®¡ç†
- `user_stats` - ç”¨æˆ·ç»Ÿè®¡æ•°æ®
- `user_notifications` - ç”¨æˆ·é€šçŸ¥ç³»ç»Ÿ

#### 2. æµ‹è¯•ç³»ç»Ÿæ¨¡å— (16ä¸ªè¡¨)
- `test_sessions` - æµ‹è¯•ä¼šè¯ç®¡ç†
- `test_results` - æµ‹è¯•ç»“æœä¸»è¡¨
- `test_queue` - æµ‹è¯•é˜Ÿåˆ—ç®¡ç†
- `test_templates` - æµ‹è¯•æ¨¡æ¿ç³»ç»Ÿ
- `test_reports` - æµ‹è¯•æŠ¥å‘Šç®¡ç†
- `test_artifacts` - æµ‹è¯•æ–‡ä»¶å’Œèµ„æº
- `test_tags` - æµ‹è¯•æ ‡ç­¾ç³»ç»Ÿ
- `test_result_tags` - æ ‡ç­¾å…³è”è¡¨
- `test_plans` - æµ‹è¯•è®¡åˆ’ç®¡ç†
- `seo_test_details` - SEOæµ‹è¯•è¯¦ç»†ç»“æœ
- `performance_test_details` - æ€§èƒ½æµ‹è¯•è¯¦ç»†ç»“æœ
- `security_test_details` - å®‰å…¨æµ‹è¯•è¯¦ç»†ç»“æœ
- `api_test_details` - APIæµ‹è¯•è¯¦ç»†ç»“æœ
- `compatibility_test_details` - å…¼å®¹æ€§æµ‹è¯•è¯¦ç»†ç»“æœ
- `stress_test_details` - å‹åŠ›æµ‹è¯•è¯¦ç»†ç»“æœ

#### 3. ç›‘æ§ç³»ç»Ÿæ¨¡å— (2ä¸ªè¡¨)
- `monitoring_sites` - ç›‘æ§ç«™ç‚¹é…ç½®
- `monitoring_results` - ç›‘æ§ç»“æœè®°å½•

#### 4. ç³»ç»Ÿç®¡ç†æ¨¡å— (6ä¸ªè¡¨)
- `system_config` - ç³»ç»Ÿé…ç½®ç®¡ç†
- `system_logs` - ç³»ç»Ÿæ—¥å¿—è®°å½•
- `system_notifications` - ç³»ç»Ÿé€šçŸ¥
- `system_stats` - ç³»ç»Ÿç»Ÿè®¡æ•°æ®
- `engine_status` - æµ‹è¯•å¼•æ“çŠ¶æ€
- `system_health` - ç³»ç»Ÿå¥åº·ç›‘æ§

#### 5. APIé›†æˆæ¨¡å— (2ä¸ªè¡¨)
- `api_keys` - APIå¯†é’¥ç®¡ç†
- `api_usage_stats` - APIä½¿ç”¨ç»Ÿè®¡

#### 6. å›¢é˜Ÿåä½œæ¨¡å— (2ä¸ªè¡¨)
- `user_teams` - å›¢é˜Ÿç®¡ç†
- `team_members` - å›¢é˜Ÿæˆå‘˜ç®¡ç†

#### 7. æ–‡ä»¶å’Œé‚®ä»¶æ¨¡å— (2ä¸ªè¡¨)
- `uploaded_files` - æ–‡ä»¶ä¸Šä¼ ç®¡ç†
- `email_queue` - é‚®ä»¶é˜Ÿåˆ—ç®¡ç†

## ğŸŒ ç¯å¢ƒé…ç½®

### åŒæ•°æ®åº“æ¶æ„
é¡¹ç›®é‡‡ç”¨**åŒæ•°æ®åº“æ¶æ„**ï¼Œè‡ªåŠ¨ç¯å¢ƒåˆ‡æ¢ï¼š

| ç¯å¢ƒ | æ•°æ®åº“å | ç”¨é€” |
|------|----------|------|
| å¼€å‘ç¯å¢ƒ | `testweb_dev` | æ—¥å¸¸å¼€å‘ã€æµ‹è¯• |
| ç”Ÿäº§ç¯å¢ƒ | `testweb_prod` | æ­£å¼éƒ¨ç½²ã€ç”¨æˆ·ä½¿ç”¨ |

### ç¯å¢ƒå˜é‡é…ç½®
```env
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=5432
DB_NAME=testweb_dev
DB_USER=postgres
DB_PASSWORD=your_password

# Redisé…ç½®
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# åº”ç”¨é…ç½®
NODE_ENV=development
PORT=3000
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é¦–æ¬¡è®¾ç½®
```bash
# 1. å®‰è£…ä¾èµ–
npm install

# 2. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œè®¾ç½®æ•°æ®åº“è¿æ¥ä¿¡æ¯

# 3. åˆå§‹åŒ–å®Œå¤‡æ•°æ®åº“
npm run db:init

# 4. éªŒè¯å®‰è£…
npm run db:health
```

### 2. éªŒè¯å®Œå¤‡æ€§
```bash
# æ£€æŸ¥è¡¨æ•°é‡ï¼ˆåº”è¯¥æ˜¯37+ï¼‰
npm run db:tables

# æ£€æŸ¥ç´¢å¼•æ•°é‡ï¼ˆåº”è¯¥æ˜¯135+ï¼‰
npm run db:indexes

# æ£€æŸ¥ç”¨æˆ·æ•°æ®
npm run db:users

# å®Œæ•´æ€§æ£€æŸ¥
npm run db:integrity
```

## ğŸ› ï¸ å®Œå¤‡ç®¡ç†å·¥å…·

### æ ¸å¿ƒç®¡ç†å‘½ä»¤
```bash
# æ•°æ®åº“åˆå§‹åŒ–
npm run db:init              # æ ‡å‡†åˆå§‹åŒ–
npm run db:init:force        # å¼ºåˆ¶åˆå§‹åŒ–
npm run db:init:test         # åŒ…å«æµ‹è¯•æ•°æ®
npm run db:reset             # å®Œå…¨é‡ç½®

# å¥åº·æ£€æŸ¥
npm run db:health            # æ ‡å‡†æ£€æŸ¥
npm run db:health:detailed   # è¯¦ç»†æ£€æŸ¥

# æ•°æ®ç®¡ç†
npm run db:tables            # åˆ—å‡ºæ‰€æœ‰è¡¨
npm run db:indexes           # åˆ—å‡ºæ‰€æœ‰ç´¢å¼•
npm run db:users             # åˆ—å‡ºæ‰€æœ‰ç”¨æˆ·
npm run db:analyze           # æ€§èƒ½åˆ†æ
npm run db:vacuum            # æ•°æ®åº“æ¸…ç†
npm run db:monitor           # å®æ—¶ç›‘æ§

# å®Œæ•´æ€§æ£€æŸ¥
npm run db:integrity         # æ•°æ®å®Œæ•´æ€§æ£€æŸ¥
npm run db:integrity:fix     # è‡ªåŠ¨ä¿®å¤é—®é¢˜
npm run db:integrity:report  # ç”Ÿæˆæ£€æŸ¥æŠ¥å‘Š

# å¤‡ä»½æ¢å¤
npm run db:backup            # åˆ›å»ºå¤‡ä»½
npm run db:restore           # æ¢å¤æ•°æ®
```

### é«˜çº§ç®¡ç†åŠŸèƒ½
```bash
# æŸ¥è¯¢æ•°æ®
node server/scripts/complete-database-manager.js query --query "SELECT * FROM users LIMIT 5"

# è¡¨æ“ä½œ
node server/scripts/complete-database-manager.js describe users
node server/scripts/complete-database-manager.js count users

# ç´¢å¼•ç®¡ç†
node server/scripts/complete-database-manager.js create-index --table users --columns email
node server/scripts/complete-database-manager.js analyze-indexes

# ç”¨æˆ·ç®¡ç†
node server/scripts/complete-database-manager.js create-user --username newuser
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### ç´¢å¼•ç­–ç•¥
- **ä¸»é”®ç´¢å¼•**: æ‰€æœ‰è¡¨éƒ½æœ‰UUIDä¸»é”®
- **å¤–é”®ç´¢å¼•**: æ‰€æœ‰å¤–é”®å­—æ®µéƒ½æœ‰ç´¢å¼•
- **æŸ¥è¯¢ç´¢å¼•**: å¸¸ç”¨æŸ¥è¯¢å­—æ®µçš„å¤åˆç´¢å¼•
- **éƒ¨åˆ†ç´¢å¼•**: æ¡ä»¶ç´¢å¼•ä¼˜åŒ–ç‰¹å®šæŸ¥è¯¢
- **æ–‡æœ¬ç´¢å¼•**: ä½¿ç”¨pg_trgmæ”¯æŒæ¨¡ç³Šæœç´¢

### æŸ¥è¯¢ä¼˜åŒ–
- æ‰€æœ‰æŸ¥è¯¢éƒ½ç»è¿‡æ€§èƒ½ä¼˜åŒ–
- æ”¯æŒåˆ†é¡µå’Œé™åˆ¶ç»“æœæ•°é‡
- ä½¿ç”¨JSONBå­—æ®µå­˜å‚¨å¤æ‚æ•°æ®ç»“æ„
- é¢„ç¼–è¯‘è¯­å¥é˜²æ­¢SQLæ³¨å…¥

### å­˜å‚¨ä¼˜åŒ–
- è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ•°æ®çš„è§¦å‘å™¨
- æ”¯æŒæ•°æ®å½’æ¡£ç­–ç•¥
- å®šæœŸVACUUMå’ŒANALYZEæ“ä½œ
- æ™ºèƒ½çš„å­˜å‚¨ç©ºé—´ç®¡ç†

## ğŸ”’ å®‰å…¨ç‰¹æ€§

### æ•°æ®å®‰å…¨
- å¯†ç ä½¿ç”¨bcryptåŠ å¯† (12è½®)
- æ•æ„Ÿæ•°æ®å­—æ®µåŠ å¯†å­˜å‚¨
- å®Œæ•´çš„å®¡è®¡æ—¥å¿—ç³»ç»Ÿ
- æ•°æ®è®¿é—®æƒé™æ§åˆ¶

### è®¿é—®æ§åˆ¶
- åŸºäºè§’è‰²çš„æƒé™ç³»ç»Ÿ (admin, moderator, user)
- APIå¯†é’¥ç®¡ç†å’Œé™æµ
- ä¼šè¯ç®¡ç†å’Œè‡ªåŠ¨è¶…æ—¶
- IPç™½åå•æ”¯æŒ

### æ•°æ®å®Œæ•´æ€§
- å¤–é”®çº¦æŸä¿è¯æ•°æ®ä¸€è‡´æ€§
- æ£€æŸ¥çº¦æŸéªŒè¯æ•°æ®æ ¼å¼
- è§¦å‘å™¨è‡ªåŠ¨ç»´æŠ¤æ•°æ®çŠ¶æ€
- å®Œæ•´çš„äº‹åŠ¡æ”¯æŒ

## ğŸ” ç›‘æ§å’Œç»´æŠ¤

### å¥åº·ç›‘æ§
- å®æ—¶è¿æ¥çŠ¶æ€ç›‘æ§
- æŸ¥è¯¢æ€§èƒ½ç›‘æ§
- å­˜å‚¨ç©ºé—´ç›‘æ§
- ç³»ç»Ÿèµ„æºç›‘æ§

### è‡ªåŠ¨åŒ–ç»´æŠ¤
- è‡ªåŠ¨æ¸…ç†è¿‡æœŸä¼šè¯
- è‡ªåŠ¨æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
- è‡ªåŠ¨å¤‡ä»½ç­–ç•¥
- è‡ªåŠ¨æ€§èƒ½ä¼˜åŒ–

### å‘Šè­¦ç³»ç»Ÿ
- æ€§èƒ½é˜ˆå€¼å‘Šè­¦
- å­˜å‚¨ç©ºé—´å‘Šè­¦
- è¿æ¥æ•°å‘Šè­¦
- é”™è¯¯ç‡å‘Šè­¦

## ğŸš¨ é‡è¦æé†’

### ç”Ÿäº§ç¯å¢ƒæ³¨æ„äº‹é¡¹
1. **ä¿®æ”¹é»˜è®¤å¯†ç **: ç®¡ç†å‘˜è´¦æˆ·é»˜è®¤å¯†ç ä¸º `admin123456`
2. **é…ç½®å¤‡ä»½ç­–ç•¥**: å»ºè®®æ¯æ—¥è‡ªåŠ¨å¤‡ä»½
3. **ç›‘æ§ç³»ç»ŸçŠ¶æ€**: å®šæœŸè¿è¡Œå¥åº·æ£€æŸ¥
4. **æ›´æ–°å®‰å…¨é…ç½®**: å®šæœŸæ£€æŸ¥æƒé™å’Œå¯†ç ç­–ç•¥

### å±é™©æ“ä½œè­¦å‘Š
- `--reset` é€‰é¡¹ä¼š**å®Œå…¨åˆ é™¤**æ‰€æœ‰æ•°æ®
- `--force` é€‰é¡¹ä¼š**è·³è¿‡ç¡®è®¤**æç¤º
- æ¢å¤æ“ä½œä¼š**è¦†ç›–ç°æœ‰**æ•°æ®

## ğŸ“ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜è§£å†³
```bash
# è¿æ¥å¤±è´¥
npm run db:health              # æ£€æŸ¥è¿æ¥çŠ¶æ€
node server/scripts/validate-env.js  # éªŒè¯ç¯å¢ƒé…ç½®

# è¡¨ç»“æ„é—®é¢˜
npm run db:integrity           # æ£€æŸ¥å®Œæ•´æ€§
npm run db:init:force          # é‡æ–°åˆå§‹åŒ–

# æ€§èƒ½é—®é¢˜
npm run db:analyze             # æ€§èƒ½åˆ†æ
npm run db:vacuum              # æ¸…ç†æ•°æ®åº“

# æ•°æ®é—®é¢˜
npm run db:integrity:fix       # è‡ªåŠ¨ä¿®å¤
npm run db:backup              # åˆ›å»ºå¤‡ä»½
```

### è·å–è¯¦ç»†å¸®åŠ©
```bash
node server/scripts/init-database.js --help
node server/scripts/complete-database-manager.js help
node server/scripts/health-check.js --help
node server/scripts/data-integrity-checker.js --help
```

---

**ç‰ˆæœ¬**: 3.0 - ä¼ä¸šçº§å®Œæ•´ç‰ˆ  
**æ›´æ–°æ—¶é—´**: 2023-12-08  
**çŠ¶æ€**: âœ… å®Œå¤‡ä¸”å¯ç”¨  
**ç»´æŠ¤å›¢é˜Ÿ**: Test Web App Development Team
