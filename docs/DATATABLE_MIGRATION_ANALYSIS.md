# DataTableç»„ä»¶è¿ç§»åˆ†ææŠ¥å‘Š

## ğŸ“‹ åˆ†ææ¦‚è¿°

**åˆ†ææ—¥æœŸ**: 2025å¹´8æœˆ2æ—¥  
**åˆ†æç›®æ ‡**: è¯„ä¼°ç°æœ‰DataTableç»„ä»¶ä¸æ–°Tableç»„ä»¶çš„å·®å¼‚ï¼Œåˆ¶å®šè¿ç§»ç­–ç•¥  
**å½“å‰çŠ¶æ€**: é¡¹ç›®ä¸­å­˜åœ¨ä¸¤ä¸ªè¡¨æ ¼ç»„ä»¶å®ç°  

## ğŸ” ç»„ä»¶å¯¹æ¯”åˆ†æ

### 1. ç°æœ‰DataTableç»„ä»¶ (src/components/shared/DataTable.tsx)

#### ç‰¹ç‚¹å’ŒåŠŸèƒ½
```tsx
// æ¥å£å®šä¹‰
interface Column<T> {
  key: keyof T;
  title: string;
  sortable?: boolean;
  render?: (value: any, record: T) => React.ReactNode;
  width?: string;
  align?: 'left' | 'center' | 'right';
}

interface DataTableProps<T> {
  columns: Column<T>[];
  data: T[];
  loading?: boolean;
  sortBy?: keyof T;
  sortOrder?: 'asc' | 'desc';
  onSort?: (key: keyof T, order: 'asc' | 'desc') => void;
  emptyText?: string;
  emptyIcon?: React.ReactNode;
  className?: string;
  rowKey?: keyof T | ((record: T) => string);
}
```

#### å®ç°ç‰¹ç‚¹
- âœ… **ç½‘æ ¼å¸ƒå±€**: ä½¿ç”¨CSS Gridè€Œä¸æ˜¯ä¼ ç»Ÿtableå…ƒç´ 
- âœ… **ä¸“ç”¨CSS**: ä¾èµ–`data-table.css`æ ·å¼æ–‡ä»¶
- âœ… **å“åº”å¼è®¾è®¡**: ç§»åŠ¨ç«¯è‡ªåŠ¨é€‚é…
- âœ… **å¯è®¿é—®æ€§**: å®Œæ•´çš„ARIAæ”¯æŒ
- âœ… **ç®€æ´API**: ç›¸å¯¹ç®€å•çš„å±æ€§æ¥å£
- âš ï¸ **åŠŸèƒ½é™åˆ¶**: ç¼ºå°‘åˆ†é¡µã€ç­›é€‰ã€è¡Œé€‰æ‹©ç­‰é«˜çº§åŠŸèƒ½

### 2. æ–°Tableç»„ä»¶ (src/components/ui/Table.tsx)

#### ç‰¹ç‚¹å’ŒåŠŸèƒ½
```tsx
// æ¥å£å®šä¹‰
interface TableColumn<T = any> {
  key: string;
  title: string;
  dataIndex?: string;
  width?: string | number;
  align?: 'left' | 'center' | 'right';
  sortable?: boolean;
  filterable?: boolean;
  render?: (value: any, record: T, index: number) => React.ReactNode;
  className?: string;
}

interface TableProps<T = any> {
  columns: TableColumn<T>[];
  data: T[];
  loading?: boolean;
  pagination?: { /* å®Œæ•´åˆ†é¡µé…ç½® */ };
  rowSelection?: { /* è¡Œé€‰æ‹©é…ç½® */ };
  onRow?: (record: T, index: number) => { /* è¡Œäº‹ä»¶ */ };
  scroll?: { x?: number | string; y?: number | string };
  size?: 'small' | 'middle' | 'large';
  bordered?: boolean;
  showHeader?: boolean;
  className?: string;
  emptyText?: React.ReactNode;
}
```

#### å®ç°ç‰¹ç‚¹
- âœ… **ä¼ ç»Ÿtableå…ƒç´ **: ä½¿ç”¨æ ‡å‡†HTML tableç»“æ„
- âœ… **åŠŸèƒ½ä¸°å¯Œ**: åˆ†é¡µã€ç­›é€‰ã€æ’åºã€è¡Œé€‰æ‹©ç­‰
- âœ… **å†…ç½®æ ·å¼**: ä½¿ç”¨Tailwind CSSï¼Œæ— éœ€ä¸“ç”¨CSSæ–‡ä»¶
- âœ… **é«˜åº¦å¯é…ç½®**: æ”¯æŒå¤šç§å°ºå¯¸ã€è¾¹æ¡†ã€æ»šåŠ¨ç­‰
- âœ… **ä¼ä¸šçº§åŠŸèƒ½**: ç±»ä¼¼Ant Design Tableçš„å®Œæ•´åŠŸèƒ½
- âš ï¸ **å¤æ‚API**: æ›´å¤šçš„é…ç½®é€‰é¡¹ï¼Œå­¦ä¹ æˆæœ¬è¾ƒé«˜

## ğŸ“Š ä½¿ç”¨æƒ…å†µåˆ†æ

### å½“å‰DataTableä½¿ç”¨æƒ…å†µ

#### 1. DataList.tsx (æ•°æ®å­˜å‚¨é¡µé¢)
```tsx
// src/pages/DataStorage/components/DataList.tsx
import { Column, DataTable } from '../../../components/shared';

<DataTable
  columns={columns}
  data={records}
  loading={loading}
  sortBy="testType"
  sortOrder={sortOrder}
  onSort={handleSort}
  emptyText="æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„æµ‹è¯•è®°å½•"
  emptyIcon={<Database className="w-16 h-16 text-gray-600 mx-auto mb-4" />}
  rowKey="id"
/>
```

**ä½¿ç”¨ç‰¹ç‚¹**:
- âœ… åŸºç¡€è¡¨æ ¼åŠŸèƒ½
- âœ… æ’åºåŠŸèƒ½
- âœ… è‡ªå®šä¹‰ç©ºçŠ¶æ€
- âœ… è‡ªå®šä¹‰æ¸²æŸ“åˆ—

#### 2. å…¶ä»–æ½œåœ¨ä½¿ç”¨ä½ç½®
- **AdvancedDataManager.tsx**: å¯èƒ½ä½¿ç”¨è¡¨æ ¼æ˜¾ç¤ºæ•°æ®
- **DataQueryPanel.tsx**: æŸ¥è¯¢ç»“æœå¯èƒ½éœ€è¦è¡¨æ ¼å±•ç¤º
- **ReportManagement**: æŠ¥å‘Šåˆ—è¡¨å¯èƒ½ä½¿ç”¨è¡¨æ ¼

### CSSä¾èµ–åˆ†æ

#### data-table.cssæ–‡ä»¶ (218è¡Œ)
```css
/* ä¸»è¦åŠŸèƒ½ */
- ç½‘æ ¼å¸ƒå±€ç±» (grid-cols-1 åˆ° grid-cols-12)
- æ··åˆå®½åº¦å¸ƒå±€ (grid-mixed-1 åˆ° grid-mixed-5)
- å›ºå®šå®½åº¦å¸ƒå±€ (grid-fixed-sm/md/lg/xl)
- æ’åºæ ·å¼ (sortable-column, sort-icon)
- å“åº”å¼è®¾è®¡
- å¯è®¿é—®æ€§å¢å¼º
- é«˜å¯¹æ¯”åº¦æ”¯æŒ
```

## ğŸ¯ è¿ç§»ç­–ç•¥

### æ–¹æ¡ˆ1: æ¸è¿›å¼è¿ç§» (æ¨è)

#### é˜¶æ®µ1: ä¿æŒå¹¶å­˜ (å½“å‰)
- âœ… ä¿ç•™ç°æœ‰DataTableç»„ä»¶
- âœ… æ–°åŠŸèƒ½ä½¿ç”¨æ–°Tableç»„ä»¶
- âœ… é¿å…ç ´åç°æœ‰åŠŸèƒ½

#### é˜¶æ®µ2: åŠŸèƒ½å¯¹ç­‰ (1-2å‘¨)
- ğŸ”„ ä¸ºæ–°Tableç»„ä»¶æ·»åŠ ç½‘æ ¼å¸ƒå±€æ”¯æŒ
- ğŸ”„ åˆ›å»ºDataTableå…¼å®¹å±‚
- ğŸ”„ æµ‹è¯•åŠŸèƒ½å¯¹ç­‰æ€§

#### é˜¶æ®µ3: é€æ­¥è¿ç§» (2-4å‘¨)
- ğŸ”„ è¿ç§»DataList.tsxåˆ°æ–°Tableç»„ä»¶
- ğŸ”„ è¿ç§»å…¶ä»–ä½¿ç”¨DataTableçš„ç»„ä»¶
- ğŸ”„ ä¿æŒè§†è§‰å’ŒåŠŸèƒ½ä¸€è‡´æ€§

#### é˜¶æ®µ4: æ¸…ç†å®Œæˆ (1å‘¨)
- ğŸ”„ åˆ é™¤æ—§DataTableç»„ä»¶
- ğŸ”„ æ¸…ç†data-table.cssæ–‡ä»¶
- ğŸ”„ æ›´æ–°å¯¼å…¥å¼•ç”¨

### æ–¹æ¡ˆ2: ç›´æ¥æ›¿æ¢ (é£é™©è¾ƒé«˜)

#### ä¼˜ç‚¹
- âœ… å¿«é€Ÿç»Ÿä¸€åˆ°æ–°ç»„ä»¶
- âœ… ç«‹å³è·å¾—æ–°åŠŸèƒ½
- âœ… å‡å°‘ç»´æŠ¤è´Ÿæ‹…

#### ç¼ºç‚¹
- âŒ å¯èƒ½ç ´åç°æœ‰åŠŸèƒ½
- âŒ éœ€è¦å¤§é‡æµ‹è¯•
- âŒ è§†è§‰æ•ˆæœå¯èƒ½ä¸ä¸€è‡´

### æ–¹æ¡ˆ3: åˆ›å»ºé€‚é…å™¨ (ä¸­ç­‰å¤æ‚åº¦)

#### å®ç°æ€è·¯
```tsx
// DataTableAdapter.tsx
import { Table, TableColumn } from '../ui/Table';
import { Column as DataTableColumn } from './DataTable';

interface DataTableAdapterProps<T> {
  columns: DataTableColumn<T>[];
  // ...å…¶ä»–DataTableå±æ€§
}

const DataTableAdapter = <T,>({ columns, ...props }: DataTableAdapterProps<T>) => {
  // è½¬æ¢åˆ—å®šä¹‰
  const tableColumns: TableColumn<T>[] = columns.map(col => ({
    key: String(col.key),
    title: col.title,
    dataIndex: String(col.key),
    align: col.align,
    sortable: col.sortable,
    render: col.render,
    width: col.width
  }));

  return (
    <Table
      columns={tableColumns}
      {...props}
      // æ¨¡æ‹Ÿç½‘æ ¼å¸ƒå±€æ ·å¼
      className="grid-layout-table"
    />
  );
};
```

## ğŸ“ˆ è¿ç§»æ•ˆç›Šåˆ†æ

### ä»£ç å‡å°‘ç»Ÿè®¡
| æ¸…ç†é¡¹ç›® | æ–‡ä»¶æ•° | ä»£ç è¡Œæ•° | å½±å“èŒƒå›´ |
|---------|--------|---------|---------|
| **DataTableç»„ä»¶** | 1ä¸ª | ~176è¡Œ | è¡¨æ ¼ç»„ä»¶ |
| **data-table.css** | 1ä¸ª | ~218è¡Œ | è¡¨æ ¼æ ·å¼ |
| **DataTable-fixes.md** | 1ä¸ª | ~116è¡Œ | æ–‡æ¡£æ–‡ä»¶ |
| **å¯¼å…¥æ›´æ–°** | 3-5ä¸ª | ~10è¡Œ | å¯¼å…¥è¯­å¥ |
| **æ€»è®¡** | 6-8ä¸ªæ–‡ä»¶ | **~520è¡Œ** | è¡¨æ ¼ç³»ç»Ÿ |

### åŠŸèƒ½æå‡
| åŠŸèƒ½ | DataTable | æ–°Table | æå‡ |
|------|-----------|---------|------|
| **åŸºç¡€è¡¨æ ¼** | âœ… | âœ… | æŒå¹³ |
| **æ’åº** | âœ… | âœ… | æŒå¹³ |
| **åˆ†é¡µ** | âŒ | âœ… | â¬†ï¸ æ–°å¢ |
| **ç­›é€‰** | âŒ | âœ… | â¬†ï¸ æ–°å¢ |
| **è¡Œé€‰æ‹©** | âŒ | âœ… | â¬†ï¸ æ–°å¢ |
| **æ»šåŠ¨** | âŒ | âœ… | â¬†ï¸ æ–°å¢ |
| **å°ºå¯¸é…ç½®** | âŒ | âœ… | â¬†ï¸ æ–°å¢ |
| **è¾¹æ¡†é…ç½®** | âŒ | âœ… | â¬†ï¸ æ–°å¢ |

### ç»´æŠ¤å¤æ‚åº¦
- **å‡å°‘**: ä¸å†éœ€è¦ç»´æŠ¤ä¸“ç”¨çš„data-table.css
- **ç»Ÿä¸€**: æ‰€æœ‰è¡¨æ ¼ä½¿ç”¨ç›¸åŒçš„ç»„ä»¶å’ŒAPI
- **ç®€åŒ–**: å‡å°‘CSSå†²çªå’Œæ ·å¼é—®é¢˜
- **æ ‡å‡†åŒ–**: ä½¿ç”¨æ ‡å‡†HTML tableå…ƒç´ 

## âš ï¸ è¿ç§»é£é™©è¯„ä¼°

### é«˜é£é™©é¡¹ç›®
1. **è§†è§‰æ•ˆæœå·®å¼‚**
   - DataTableä½¿ç”¨ç½‘æ ¼å¸ƒå±€
   - æ–°Tableä½¿ç”¨ä¼ ç»Ÿtableå¸ƒå±€
   - å¯èƒ½å¯¼è‡´è§†è§‰ä¸ä¸€è‡´

2. **å“åº”å¼è¡Œä¸º**
   - DataTableæœ‰ä¸“é—¨çš„ç§»åŠ¨ç«¯é€‚é…
   - æ–°Tableçš„å“åº”å¼å¯èƒ½ä¸åŒ

### ä¸­é£é™©é¡¹ç›®
1. **APIå·®å¼‚**
   - åˆ—å®šä¹‰æ¥å£ä¸åŒ
   - å±æ€§åç§°æœ‰å·®å¼‚
   - éœ€è¦ä»£ç ä¿®æ”¹

2. **CSSä¾èµ–**
   - data-table.cssçš„ç½‘æ ¼ç±»å¯èƒ½è¢«å…¶ä»–åœ°æ–¹ä½¿ç”¨
   - éœ€è¦ä»”ç»†æ£€æŸ¥ä¾èµ–å…³ç³»

### ä½é£é™©é¡¹ç›®
1. **åŸºç¡€åŠŸèƒ½**
   - æ’åºã€æ¸²æŸ“ç­‰æ ¸å¿ƒåŠŸèƒ½ç›¸ä¼¼
   - è¿ç§»ç›¸å¯¹ç®€å•

2. **TypeScriptæ”¯æŒ**
   - ä¸¤ä¸ªç»„ä»¶éƒ½æœ‰å®Œæ•´çš„ç±»å‹å®šä¹‰
   - ç¼–è¯‘æ—¶å¯ä»¥å‘ç°é—®é¢˜

## ğŸš€ æ¨èæ‰§è¡Œè®¡åˆ’

### ç«‹å³è¡ŒåŠ¨ (æœ¬å‘¨)
1. **åˆ›å»ºå…¼å®¹å±‚**
   ```tsx
   // åˆ›å»º DataTableCompat.tsx
   // æä¾›DataTableåˆ°Tableçš„å…¼å®¹é€‚é…
   ```

2. **æµ‹è¯•æ–°Tableç»„ä»¶**
   - åœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨æ–°Tableç»„ä»¶
   - éªŒè¯åŠŸèƒ½å®Œæ•´æ€§
   - æµ‹è¯•å“åº”å¼è¡¨ç°

### ä¸­æœŸè¡ŒåŠ¨ (ä¸‹å‘¨)
1. **è¿ç§»DataListç»„ä»¶**
   - ä½œä¸ºè¯•ç‚¹è¿ç§»DataList.tsx
   - ä¿æŒç›¸åŒçš„è§†è§‰æ•ˆæœ
   - æµ‹è¯•æ‰€æœ‰åŠŸèƒ½æ­£å¸¸

2. **è¯„ä¼°å…¶ä»–ä½¿ç”¨ä½ç½®**
   - æ£€æŸ¥æ‰€æœ‰å¯èƒ½ä½¿ç”¨DataTableçš„åœ°æ–¹
   - åˆ¶å®šè¯¦ç»†çš„è¿ç§»è®¡åˆ’

### é•¿æœŸè¡ŒåŠ¨ (2-4å‘¨)
1. **å®Œæˆå…¨éƒ¨è¿ç§»**
   - è¿ç§»æ‰€æœ‰DataTableä½¿ç”¨
   - åˆ é™¤æ—§ç»„ä»¶å’ŒCSSæ–‡ä»¶
   - æ›´æ–°æ–‡æ¡£å’Œç¤ºä¾‹

## âœ… éªŒè¯æ¸…å•

### åŠŸèƒ½éªŒè¯
- [ ] è¡¨æ ¼æ•°æ®æ­£ç¡®æ˜¾ç¤º
- [ ] æ’åºåŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] è‡ªå®šä¹‰æ¸²æŸ“æ­£ç¡®
- [ ] ç©ºçŠ¶æ€æ˜¾ç¤ºæ­£å¸¸
- [ ] åŠ è½½çŠ¶æ€æ­£ç¡®
- [ ] è¡Œé”®å€¼ç”Ÿæˆæ­£ç¡®

### è§†è§‰éªŒè¯
- [ ] è¡¨æ ¼æ ·å¼ä¸åŸç‰ˆä¸€è‡´
- [ ] å“åº”å¼è®¾è®¡æ­£å¸¸
- [ ] ä¸»é¢˜åˆ‡æ¢æ­£å¸¸
- [ ] åŠ¨ç”»æ•ˆæœæµç•…

### æ€§èƒ½éªŒè¯
- [ ] å¤§æ•°æ®é‡æ¸²æŸ“æ€§èƒ½
- [ ] å†…å­˜ä½¿ç”¨æ— å¼‚å¸¸
- [ ] æ»šåŠ¨æ€§èƒ½è‰¯å¥½

---

**åˆ†æç»“è®º**: âœ… å¯ä»¥å®‰å…¨è¿ç§»  
**æ¨èæ–¹æ¡ˆ**: æ¸è¿›å¼è¿ç§»  
**é¢„è®¡å·¥ä½œé‡**: 2-4å‘¨  
**é£é™©ç­‰çº§**: ğŸŸ¡ ä¸­ç­‰é£é™©  
**å»ºè®®å¼€å§‹**: ç«‹å³åˆ›å»ºå…¼å®¹å±‚
