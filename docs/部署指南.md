# Test Web App å®Œæ•´éƒ¨ç½²æŒ‡å—

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### æ–¹æ³•1ï¼šå¼€å‘ç¯å¢ƒéƒ¨ç½²ï¼ˆæ¨èæ–°æ‰‹ï¼‰
```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd Test-Web

# 2. å®‰è£…ä¾èµ–
npm install

# 3. é…ç½®æ•°æ®åº“
# åˆ›å»ºPostgreSQLæ•°æ®åº“ testweb_dev
psql -U postgres -c "CREATE DATABASE testweb_dev;"

# 4. é…ç½®ç¯å¢ƒå˜é‡
# ç¡®ä¿ .env æ–‡ä»¶ä¸­ DB_NAME=testweb_dev

# 5. åˆå§‹åŒ–æ•°æ®åº“
npm run db:init

# 6. å¯åŠ¨æœåŠ¡
npm start
```

### æ–¹æ³•2ï¼šç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
```bash
# 1. åˆ›å»ºç”Ÿäº§æ•°æ®åº“
psql -U postgres -c "CREATE DATABASE testweb_prod;"

# 2. é…ç½®ç”Ÿäº§ç¯å¢ƒå˜é‡
cp .env.production .env
# ä¿®æ”¹ .env ä¸­çš„ç”Ÿäº§é…ç½®

# 3. æ„å»ºå‰ç«¯
npm run build

# 4. å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
NODE_ENV=production npm start
```

### æ–¹æ³•3ï¼šDocker éƒ¨ç½²
```bash
# æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d

# æŸ¥çœ‹çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

## ğŸ“‹ éƒ¨ç½²è¦æ±‚

### ç³»ç»Ÿè¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Windows 10+, macOS 10.15+, Ubuntu 18.04+
- **Node.js**: >= 18.0.0
- **npm**: >= 9.0.0
- **PostgreSQL**: >= 12.0
- **Redis**: >= 6.0 (å¯é€‰ï¼Œç”¨äºç¼“å­˜å’Œä¼šè¯ç®¡ç†)

### ç¡¬ä»¶è¦æ±‚
- **CPU**: 2æ ¸å¿ƒä»¥ä¸Š (æ¨è4æ ¸å¿ƒ+)
- **å†…å­˜**: 4GB+ RAM (æ¨è8GB+)
- **ç£ç›˜**: 20GB+ å¯ç”¨ç©ºé—´ (æ¨èSSD)
- **ç½‘ç»œ**: ç¨³å®šçš„äº’è”ç½‘è¿æ¥
- **å¸¦å®½**: 100Mbps+ (ç”¨äºå‹åŠ›æµ‹è¯•å’Œç›‘æ§)

## ğŸ”§ ç¯å¢ƒé…ç½®

### 1. PostgreSQL æ•°æ®åº“è®¾ç½®
```sql
-- åˆ›å»ºæ•°æ®åº“
CREATE DATABASE testweb_prod;

-- åˆ›å»ºç”¨æˆ·ï¼ˆå¯é€‰ï¼‰
CREATE USER testweb_user WITH PASSWORD 'secure_password';
GRANT ALL PRIVILEGES ON DATABASE testweb_prod TO testweb_user;
```

### 2. ç¯å¢ƒå˜é‡é…ç½® (server/.env)
```env
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=5432
DB_NAME=testweb_prod
DB_USER=postgres
DB_PASSWORD=your_secure_password

# åº”ç”¨é…ç½®
NODE_ENV=production
PORT=3001
JWT_SECRET=your_super_secret_jwt_key_here

# Redisé…ç½® (å¯é€‰)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password

# æ—¥å¿—é…ç½®
LOG_LEVEL=info
LOG_FILE_PATH=./logs
LOG_MAX_SIZE=10MB
LOG_MAX_FILES=5

# é›†æˆé…ç½®
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=noreply@example.com
SMTP_PASSWORD=your_smtp_password

# å¯é€‰é…ç½®
CORS_ORIGIN=http://localhost:5174
RATE_LIMIT_WINDOW=15
RATE_LIMIT_MAX=100
```

### 3. ä¾èµ–å®‰è£…
```bash
# å‰ç«¯ä¾èµ–
npm install

# åç«¯ä¾èµ–
cd server
npm install
```

## ğŸŒ ç”Ÿäº§ç¯å¢ƒé…ç½®

### Nginx é…ç½®
```nginx
server {
    listen 80;
    server_name your-domain.com;

    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /path/to/Test-Web/dist;
        try_files $uri $uri/ /index.html;
    }

    # APIä»£ç†
    location /api/ {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
```

### PM2 è¿›ç¨‹ç®¡ç†
```bash
# å®‰è£…PM2
npm install -g pm2

# å¯åŠ¨åº”ç”¨
pm2 start server/app.js --name "testweb-api"

# æŸ¥çœ‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs testweb-api

# é‡å¯åº”ç”¨
pm2 restart testweb-api

# å¼€æœºè‡ªå¯
pm2 startup
pm2 save
```

## ğŸ”’ å®‰å…¨é…ç½®

### SSL/TLS é…ç½®
```bash
# ä½¿ç”¨ Let's Encrypt è·å–å…è´¹è¯ä¹¦
sudo certbot --nginx -d your-domain.com
```

### é˜²ç«å¢™è®¾ç½®
```bash
# Ubuntu/Debian
sudo ufw allow 22    # SSH
sudo ufw allow 80    # HTTP
sudo ufw allow 443   # HTTPS
sudo ufw enable

# CentOS/RHEL
sudo firewall-cmd --permanent --add-service=ssh
sudo firewall-cmd --permanent --add-service=http
sudo firewall-cmd --permanent --add-service=https
sudo firewall-cmd --reload
```

### æ•°æ®åº“å®‰å…¨
```postgresql
-- ä¿®æ”¹é»˜è®¤å¯†ç 
ALTER USER postgres PASSWORD 'new_secure_password';

-- é™åˆ¶è¿æ¥
-- ç¼–è¾‘ postgresql.conf
listen_addresses = 'localhost'

-- ç¼–è¾‘ pg_hba.conf
local   all             all                                     md5
host    all             all             127.0.0.1/32            md5
```

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### æ—¥å¿—ç®¡ç†
```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f server/logs/combined.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f server/logs/error.log

# æŸ¥çœ‹è®¿é—®æ—¥å¿—
tail -f server/logs/access.log
```

### æ€§èƒ½ç›‘æ§
- **CPUä½¿ç”¨ç‡**: ç›‘æ§æœåŠ¡å™¨CPUè´Ÿè½½
- **å†…å­˜ä½¿ç”¨**: ç›‘æ§å†…å­˜å ç”¨æƒ…å†µ
- **ç£ç›˜ç©ºé—´**: å®šæœŸæ¸…ç†æ—¥å¿—å’Œä¸´æ—¶æ–‡ä»¶
- **æ•°æ®åº“æ€§èƒ½**: ç›‘æ§PostgreSQLæ€§èƒ½æŒ‡æ ‡

### æ•°æ®å¤‡ä»½
```bash
# æ•°æ®åº“å¤‡ä»½
pg_dump testweb_prod > backup_$(date +%Y%m%d_%H%M%S).sql

# åº”ç”¨æ–‡ä»¶å¤‡ä»½
tar -czf app_backup_$(date +%Y%m%d_%H%M%S).tar.gz /path/to/Test-Web
```

## ğŸ”„ æ›´æ–°å’Œç»´æŠ¤

### åº”ç”¨æ›´æ–°
```bash
# 1. å¤‡ä»½å½“å‰ç‰ˆæœ¬
cp -r Test-Web Test-Web-backup

# 2. æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# 3. æ›´æ–°ä¾èµ–
npm install
cd server && npm install && cd ..

# 4. é‡æ–°æ„å»º
npm run build

# 5. é‡å¯æœåŠ¡
pm2 restart testweb-api
```

### æ•°æ®åº“ç»´æŠ¤
```sql
-- æ¸…ç†è¿‡æœŸæ•°æ®
DELETE FROM test_history WHERE created_at < NOW() - INTERVAL '90 days';

-- é‡å»ºç´¢å¼•
REINDEX DATABASE testweb_prod;

-- æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
ANALYZE;
```

## ğŸ“ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**1. ç«¯å£å ç”¨**
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tulpn | grep :3001
lsof -i :3001

# æ€æ­»å ç”¨è¿›ç¨‹
kill -9 <PID>
```

**2. æ•°æ®åº“è¿æ¥å¤±è´¥**
```bash
# æ£€æŸ¥PostgreSQLçŠ¶æ€
sudo systemctl status postgresql

# é‡å¯PostgreSQL
sudo systemctl restart postgresql

# æ£€æŸ¥è¿æ¥
psql -h localhost -U postgres -d testweb_prod
```

**3. å†…å­˜ä¸è¶³**
```bash
# æ£€æŸ¥å†…å­˜ä½¿ç”¨
free -h
top

# æ¸…ç†ç¼“å­˜
sudo sync && sudo sysctl vm.drop_caches=3
```

## ğŸ”— æ–°åŠŸèƒ½éƒ¨ç½²é…ç½®

### ä¼ä¸šçº§é›†æˆé…ç½®

#### Slacké›†æˆ
```env
# Slack Webhooké…ç½®
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/...
SLACK_DEFAULT_CHANNEL=#testing
SLACK_BOT_NAME=TestBot
```

#### Jenkinsé›†æˆ
```env
# Jenkinsé…ç½®
JENKINS_SERVER_URL=https://jenkins.company.com
JENKINS_API_TOKEN=your_jenkins_token
JENKINS_DEFAULT_JOB=website-test-pipeline
```

#### é‚®ä»¶é€šçŸ¥é…ç½®
```env
# SMTPé…ç½®
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your_email@gmail.com
SMTP_PASSWORD=your_app_password
```

### æ™ºèƒ½æŠ¥å‘Šç³»ç»Ÿé…ç½®

#### æŠ¥å‘Šå­˜å‚¨é…ç½®
```env
# æŠ¥å‘Šæ–‡ä»¶å­˜å‚¨
REPORTS_STORAGE_PATH=./reports
REPORTS_MAX_SIZE=100MB
REPORTS_RETENTION_DAYS=30
```

#### PDFç”Ÿæˆé…ç½®
```env
# PDFç”ŸæˆæœåŠ¡
PDF_SERVICE_URL=http://localhost:3002
PDF_TIMEOUT=30000
PDF_QUALITY=high
```

### ç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿé…ç½®

#### æ—¥å¿—çº§åˆ«é…ç½®
```env
# æ—¥å¿—é…ç½®
LOG_LEVEL=info
LOG_FORMAT=json
LOG_TIMESTAMP=true
LOG_COLORS=false
```

#### è¿œç¨‹æ—¥å¿—é…ç½®
```env
# è¿œç¨‹æ—¥å¿—æœåŠ¡
REMOTE_LOGGING_ENABLED=true
REMOTE_LOG_ENDPOINT=https://logs.company.com/api/ingest
REMOTE_LOG_API_KEY=your_log_api_key
```

### Redisç¼“å­˜é…ç½®

#### åŸºç¡€Redisé…ç½®
```env
# Redisé…ç½®
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password
REDIS_DB=0
REDIS_TTL=3600
```

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### å¥åº·æ£€æŸ¥ç«¯ç‚¹
```bash
# åº”ç”¨å¥åº·æ£€æŸ¥
curl http://localhost:3001/health

# æ•°æ®åº“è¿æ¥æ£€æŸ¥
curl http://localhost:3001/health/db

# Redisè¿æ¥æ£€æŸ¥
curl http://localhost:3001/health/redis
```

### æ—¥å¿—ç›‘æ§
```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f logs/combined.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f logs/error.log

# æŸ¥çœ‹è®¿é—®æ—¥å¿—
tail -f logs/access.log
```

### æŠ€æœ¯æ”¯æŒ

å¦‚éœ€æŠ€æœ¯æ”¯æŒï¼Œè¯·æä¾›ï¼š
1. é”™è¯¯æ—¥å¿—ä¿¡æ¯
2. ç³»ç»Ÿç¯å¢ƒä¿¡æ¯
3. éƒ¨ç½²é…ç½®è¯¦æƒ…
4. é—®é¢˜å¤ç°æ­¥éª¤
5. ç›‘æ§æ•°æ®å’Œæ€§èƒ½æŒ‡æ ‡

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å¯åŠ¨æŒ‡å—](å¯åŠ¨æŒ‡å—.md)
- [é¡¹ç›®ç»“æ„è¯´æ˜](é¡¹ç›®ç»“æ„è¯´æ˜.md)
- [åŠŸèƒ½ç‰¹æ€§è¯´æ˜](åŠŸèƒ½ç‰¹æ€§è¯´æ˜.md)
- [PostgreSQLé…ç½®](POSTGRESQL_SETUP.md)
- [ä¼ä¸šçº§é›†æˆæŒ‡å—](ENTERPRISE_INTEGRATIONS.md)
- [æ™ºèƒ½æŠ¥å‘Šç³»ç»ŸæŒ‡å—](INTELLIGENT_REPORTS.md)
- [ç»Ÿä¸€æ—¥å¿—ç³»ç»ŸæŒ‡å—](UNIFIED_LOGGING.md)
