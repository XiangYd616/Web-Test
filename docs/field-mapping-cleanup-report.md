# å­—æ®µæ˜ å°„æ¸…ç†æŠ¥å‘Š

## ğŸ¯ æ¦‚è¿°

æœ¬æŠ¥å‘Šæ€»ç»“äº†é¡¹ç›®ä¸­å‰åç«¯å­—æ®µåä¸ä¸€è‡´é—®é¢˜çš„å…¨é¢æ¸…ç†å·¥ä½œã€‚æˆ‘ä»¬ç»Ÿä¸€äº†å‰åç«¯çš„å­—æ®µå‘½åçº¦å®šï¼Œæ¶ˆé™¤äº†ä¸å¿…è¦çš„å­—æ®µæ˜ å°„ï¼Œæé«˜äº†ä»£ç çš„ä¸€è‡´æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

## ğŸ› å‘ç°çš„é—®é¢˜

### 1. å‰åç«¯å­—æ®µåä¸ä¸€è‡´
- **å‰ç«¯ä½¿ç”¨**ï¼š`createdAt`, `updatedAt`, `startTime`, `endTime`
- **åç«¯æœŸæœ›**ï¼š`created_at`, `updated_at`, `start_time`, `end_time`
- **å½±å“**ï¼šå¯¼è‡´APIè°ƒç”¨å¤±è´¥ï¼Œè¿”å›400 Bad Requesté”™è¯¯

### 2. ä¸å¿…è¦çš„å­—æ®µæ˜ å°„
å¤šä¸ªæ–‡ä»¶ä¸­å­˜åœ¨å¤æ‚çš„å­—æ®µæ˜ å°„é€»è¾‘ï¼Œå¢åŠ äº†ä»£ç å¤æ‚æ€§å’Œç»´æŠ¤æˆæœ¬ã€‚

## âœ… ä¿®å¤å†…å®¹

### 1. StressTestHistory.tsx
**ä¿®å¤å‰**ï¼š
```typescript
const [sortBy, setSortBy] = useState<'createdAt' | 'duration' | 'score'>('createdAt');

// æ˜ å°„å‰ç«¯å­—æ®µååˆ°åç«¯å­—æ®µå
const sortByMapping: Record<string, string> = {
  'createdAt': 'created_at',
  'duration': 'duration',
  'score': 'overall_score'
};
```

**ä¿®å¤å**ï¼š
```typescript
const [sortBy, setSortBy] = useState<'created_at' | 'duration' | 'start_time' | 'status'>('created_at');

// ç›´æ¥ä½¿ç”¨æ•°æ®åº“å­—æ®µåï¼Œæ— éœ€æ˜ å°„
if (params.sortBy) queryParams.append('sortBy', params.sortBy);
```

### 2. æ•°æ®ç®¡ç†è·¯ç”± (server/routes/dataManagement.js)
**ä¿®å¤å‰**ï¼š
```javascript
const sortFieldMap = {
  'createdAt': 'created_at',
  'updatedAt': 'updated_at',
  'startTime': 'start_time',
  'endTime': 'end_time'
};
const dbSortField = sortFieldMap[sortBy] || sortBy;
```

**ä¿®å¤å**ï¼š
```javascript
const validSortFields = ['created_at', 'updated_at', 'start_time', 'end_time', 'status', 'test_type'];
const dbSortField = validSortFields.includes(sortBy) ? sortBy : 'created_at';
```

### 3. å‰ç«¯æ•°æ®ç®¡ç†ç»„ä»¶
**ä¿®å¤çš„æ–‡ä»¶**ï¼š
- `src/hooks/useDataManagement.ts`
- `src/components/data/AdvancedDataManager.tsx`
- `src/pages/admin/DataStorage.tsx`

**ä¿®å¤å†…å®¹**ï¼š
- ç»Ÿä¸€ä½¿ç”¨ `created_at` æ›¿ä»£ `createdAt`
- æ›´æ–°UIé€‰é¡¹å€¼ä»¥åŒ¹é…æ•°æ®åº“å­—æ®µå
- ç§»é™¤ä¸å¿…è¦çš„å­—æ®µè½¬æ¢é€»è¾‘

### 4. æœåŠ¡å±‚ä¿®å¤
**æ–‡ä»¶**ï¼š`server/services/dataManagement/index.js`

**ä¿®å¤å‰**ï¼š
```javascript
// æ ¼å¼åŒ–æ—¶é—´
createdAt: record.created_at,
updatedAt: record.updated_at,
startTime: record.start_time,
endTime: record.end_time
```

**ä¿®å¤å**ï¼š
```javascript
// ä¿æŒæ•°æ®åº“å­—æ®µå
created_at: record.created_at,
updated_at: record.updated_at,
start_time: record.start_time,
end_time: record.end_time
```

### 5. æ–‡æ¡£æ›´æ–°
**æ–‡ä»¶**ï¼š`docs/API_REFERENCE.md`

æ›´æ–°äº†APIæ–‡æ¡£ç¤ºä¾‹ï¼Œä½¿ç”¨æ­£ç¡®çš„æ•°æ®åº“å­—æ®µåã€‚

## ğŸš€ ä¿®å¤æ•ˆæœ

### 1. æ¶ˆé™¤400é”™è¯¯
- å‰ç«¯APIè°ƒç”¨ä¸å†å› å­—æ®µåä¸åŒ¹é…è€Œå¤±è´¥
- æµ‹è¯•å†å²é¡µé¢æ­£å¸¸åŠ è½½
- æ•°æ®ç®¡ç†åŠŸèƒ½æ­£å¸¸å·¥ä½œ

### 2. ä»£ç ç®€åŒ–
- ç§»é™¤äº†å¤æ‚çš„å­—æ®µæ˜ å°„é€»è¾‘
- å‡å°‘äº†ä»£ç è¡Œæ•°å’Œç»´æŠ¤æˆæœ¬
- æé«˜äº†ä»£ç å¯è¯»æ€§

### 3. ä¸€è‡´æ€§æå‡
- å‰åç«¯ä½¿ç”¨ç»Ÿä¸€çš„å­—æ®µå‘½åçº¦å®š
- å‡å°‘äº†å¼€å‘è€…çš„è®¤çŸ¥è´Ÿæ‹…
- é™ä½äº†æ–°åŠŸèƒ½å¼€å‘æ—¶çš„é”™è¯¯ç‡

## ğŸ“‹ ç»Ÿä¸€çš„å­—æ®µå‘½åçº¦å®š

### æ•°æ®åº“å­—æ®µåï¼ˆsnake_caseï¼‰
- `created_at` - åˆ›å»ºæ—¶é—´
- `updated_at` - æ›´æ–°æ—¶é—´
- `start_time` - å¼€å§‹æ—¶é—´
- `end_time` - ç»“æŸæ—¶é—´
- `test_type` - æµ‹è¯•ç±»å‹
- `overall_score` - æ€»ä½“è¯„åˆ†

### å‰ç«¯å­—æ®µåï¼ˆä¸æ•°æ®åº“ä¸€è‡´ï¼‰
å‰ç«¯ç°åœ¨ç›´æ¥ä½¿ç”¨æ•°æ®åº“å­—æ®µåï¼Œä¸å†è¿›è¡Œè½¬æ¢ã€‚

## ğŸ” éªŒè¯ç»“æœ

### 1. åŠŸèƒ½æµ‹è¯•
- âœ… æµ‹è¯•å†å²é¡µé¢æ­£å¸¸åŠ è½½
- âœ… æ’åºåŠŸèƒ½æ­£å¸¸å·¥ä½œ
- âœ… æ•°æ®ç®¡ç†é¡µé¢æ­£å¸¸å·¥ä½œ
- âœ… APIè°ƒç”¨æˆåŠŸ

### 2. ä»£ç è´¨é‡
- âœ… ç§»é™¤äº†æ‰€æœ‰ä¸å¿…è¦çš„å­—æ®µæ˜ å°„
- âœ… ç»Ÿä¸€äº†å‘½åçº¦å®š
- âœ… ç®€åŒ–äº†ä»£ç é€»è¾‘

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. å­—æ®µå‘½ååŸåˆ™
- **ä¸€è‡´æ€§**ï¼šå‰åç«¯ä½¿ç”¨ç›¸åŒçš„å­—æ®µå
- **ç®€æ´æ€§**ï¼šé¿å…å¤æ‚çš„å­—æ®µæ˜ å°„
- **å¯ç»´æŠ¤æ€§**ï¼šå‡å°‘è½¬æ¢é€»è¾‘

### 2. å¼€å‘å»ºè®®
- æ–°åŠŸèƒ½å¼€å‘æ—¶ç›´æ¥ä½¿ç”¨æ•°æ®åº“å­—æ®µå
- é¿å…åœ¨å‰åç«¯ä¹‹é—´è¿›è¡Œå­—æ®µåè½¬æ¢
- ä¼˜å…ˆè€ƒè™‘æ•°æ®åº“è®¾è®¡çš„ä¸€è‡´æ€§

### 3. ä»£ç å®¡æŸ¥è¦ç‚¹
- æ£€æŸ¥æ˜¯å¦æœ‰ä¸å¿…è¦çš„å­—æ®µæ˜ å°„
- ç¡®ä¿å‰åç«¯å­—æ®µåä¸€è‡´
- éªŒè¯APIæ–‡æ¡£çš„å‡†ç¡®æ€§

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [æ•°æ®åº“æ¶æ„æ–‡æ¡£](./DATABASE_SCHEMA.md)
- [APIæ¥å£æ–‡æ¡£](./API_REFERENCE.md)
- [ä»£ç è§„èŒƒ](./CODE_STYLE.md)

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒï¼š
1. æ•°æ®åº“æ¶æ„æ–‡æ¡£
2. APIæ¥å£æ–‡æ¡£
3. å¼€å‘å›¢é˜ŸæŠ€æœ¯æ”¯æŒ

---

**æ¸…ç†å®Œæˆæ—¶é—´**ï¼š2025å¹´8æœˆ6æ—¥  
**æ¸…ç†çŠ¶æ€**ï¼šâœ… å®Œæˆ  
**å½±å“èŒƒå›´**ï¼šå‰ç«¯ç»„ä»¶ã€åç«¯APIã€æ•°æ®åº“æŸ¥è¯¢ã€æ–‡æ¡£  
**æµ‹è¯•çŠ¶æ€**ï¼šâœ… é€šè¿‡
