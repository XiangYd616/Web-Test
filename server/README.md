# Test Web App - Backend API Server

ä¸“ä¸šçš„ç½‘ç«™æµ‹è¯•å¹³å°åç«¯APIæœåŠ¡ï¼Œæä¾›å®Œæ•´çš„æµ‹è¯•å¼•æ“é›†æˆã€ç”¨æˆ·ç®¡ç†ã€æ•°æ®å­˜å‚¨ç­‰åŠŸèƒ½ã€‚

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- **ç”¨æˆ·è®¤è¯ç³»ç»Ÿ** - JWTä»¤ç‰Œè®¤è¯ã€ç”¨æˆ·æ³¨å†Œç™»å½•ã€æƒé™ç®¡ç†
- **æµ‹è¯•å¼•æ“é›†æˆ** - K6æ€§èƒ½æµ‹è¯•ã€Lighthouse UXæµ‹è¯•ã€Playwrightå…¼å®¹æ€§æµ‹è¯•
- **å®æ—¶ç›‘æ§** - ç½‘ç«™ç›‘æ§ã€å‘Šè­¦ç³»ç»Ÿã€çŠ¶æ€è·Ÿè¸ª
- **æµ‹è¯•å†å²** - å®Œæ•´çš„æµ‹è¯•è®°å½•ã€ç»“æœåˆ†æã€æŠ¥å‘Šç”Ÿæˆ
- **APIç®¡ç†** - RESTful APIã€é€Ÿç‡é™åˆ¶ã€æ–‡æ¡£ç”Ÿæˆ

### æµ‹è¯•ç±»å‹
- **æ€§èƒ½æµ‹è¯•** - ä½¿ç”¨K6è¿›è¡Œè´Ÿè½½æµ‹è¯•ã€å‹åŠ›æµ‹è¯•ã€å³°å€¼æµ‹è¯•
- **UXæµ‹è¯•** - ä½¿ç”¨Lighthouseè¿›è¡Œæ€§èƒ½ã€å¯è®¿é—®æ€§ã€SEOåˆ†æ
- **å…¼å®¹æ€§æµ‹è¯•** - ä½¿ç”¨Playwrightè¿›è¡Œå¤šæµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•
- **å®‰å…¨æµ‹è¯•** - SSLæ£€æŸ¥ã€æ··åˆå†…å®¹æ£€æµ‹ã€å®‰å…¨å¤´éªŒè¯
- **SEOæµ‹è¯•** - å…ƒæ ‡ç­¾åˆ†æã€ç»“æ„åŒ–æ•°æ®æ£€æŸ¥ã€é¡µé¢ä¼˜åŒ–å»ºè®®

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯æ¡†æ¶
- **Node.js** - è¿è¡Œæ—¶ç¯å¢ƒ
- **Express.js** - Webåº”ç”¨æ¡†æ¶
- **Sequelize** - ORMæ•°æ®åº“æ“ä½œ
- **PostgreSQL** - ä¸»æ•°æ®åº“
- **Redis** - ç¼“å­˜å’Œä¼šè¯å­˜å‚¨

### æµ‹è¯•å¼•æ“
- **K6** - æ€§èƒ½å’Œè´Ÿè½½æµ‹è¯•
- **Lighthouse** - ç½‘é¡µè´¨é‡å®¡è®¡
- **Playwright** - æµè§ˆå™¨è‡ªåŠ¨åŒ–æµ‹è¯•

### å®‰å…¨å’Œä¸­é—´ä»¶
- **Helmet** - å®‰å…¨å¤´è®¾ç½®
- **CORS** - è·¨åŸŸèµ„æºå…±äº«
- **Rate Limiting** - APIé€Ÿç‡é™åˆ¶
- **JWT** - èº«ä»½éªŒè¯ä»¤ç‰Œ
- **bcryptjs** - å¯†ç åŠ å¯†

## ğŸ“ é¡¹ç›®ç»“æ„

```
server/
â”œâ”€â”€ app.js                 # ä¸»åº”ç”¨æ–‡ä»¶
â”œâ”€â”€ package.json           # é¡¹ç›®ä¾èµ–é…ç½®
â”œâ”€â”€ config/
â”‚   â””â”€â”€ database.js        # æ•°æ®åº“é…ç½®
â”œâ”€â”€ models/                # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ User.js           # ç”¨æˆ·æ¨¡å‹
â”‚   â”œâ”€â”€ TestHistory.js    # æµ‹è¯•å†å²æ¨¡å‹
â”‚   â”œâ”€â”€ TestSchedule.js   # æµ‹è¯•è°ƒåº¦æ¨¡å‹
â”‚   â”œâ”€â”€ MonitoringSite.js # ç›‘æ§ç«™ç‚¹æ¨¡å‹
â”‚   â”œâ”€â”€ MonitoringAlert.js # ç›‘æ§å‘Šè­¦æ¨¡å‹
â”‚   â”œâ”€â”€ TestTemplate.js   # æµ‹è¯•æ¨¡æ¿æ¨¡å‹
â”‚   â””â”€â”€ ApiKey.js         # APIå¯†é’¥æ¨¡å‹
â”œâ”€â”€ routes/               # è·¯ç”±å¤„ç†
â”‚   â”œâ”€â”€ auth.js          # è®¤è¯è·¯ç”±
â”‚   â”œâ”€â”€ users.js         # ç”¨æˆ·ç®¡ç†è·¯ç”±
â”‚   â”œâ”€â”€ tests.js         # æµ‹è¯•æ‰§è¡Œè·¯ç”±
â”‚   â””â”€â”€ testEngines.js   # æµ‹è¯•å¼•æ“è·¯ç”±
â”œâ”€â”€ middleware/           # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ auth.js          # è®¤è¯ä¸­é—´ä»¶
â”‚   â””â”€â”€ errorHandler.js  # é”™è¯¯å¤„ç†ä¸­é—´ä»¶
â”œâ”€â”€ services/            # ä¸šåŠ¡æœåŠ¡
â”‚   â””â”€â”€ testEngines.js   # æµ‹è¯•å¼•æ“æœåŠ¡
â””â”€â”€ docs/               # APIæ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js >= 18.0.0
- PostgreSQL >= 13
- Redis >= 6
- Docker (å¯é€‰)

### å®‰è£…ä¾èµ–
```bash
cd server
npm install
```

### ç¯å¢ƒé…ç½®
å¤åˆ¶ç¯å¢ƒé…ç½®æ–‡ä»¶å¹¶å¡«å…¥å®é™…å€¼ï¼š
```bash
cp .env.example .env
```

ä¸»è¦é…ç½®é¡¹ï¼š
```env
# æ•°æ®åº“é…ç½® - è‡ªåŠ¨ç¯å¢ƒåˆ‡æ¢
# å¼€å‘ç¯å¢ƒ: testweb_dev, ç”Ÿäº§ç¯å¢ƒ: testweb_prod
DB_HOST=localhost
DB_PORT=5432
DB_NAME=testweb_dev
DB_USER=postgres
DB_PASSWORD=postgres

# JWTé…ç½®
JWT_SECRET=your_super_secret_key

# Redisé…ç½®
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password
```

### æ•°æ®åº“åˆå§‹åŒ–
```bash
# åˆ›å»ºæ•°æ®åº“
npm run db:create

# è¿è¡Œè¿ç§»
npm run migrate

# å¡«å……ç§å­æ•°æ®ï¼ˆå¯é€‰ï¼‰
npm run seed
```

### å¯åŠ¨æœåŠ¡

âš ï¸ **é‡è¦**: è¯·åœ¨é¡¹ç›®æ ¹ç›®å½•å¯åŠ¨ï¼Œä¸è¦åœ¨serverç›®å½•å¯åŠ¨ï¼

```bash
# è¿”å›é¡¹ç›®æ ¹ç›®å½•
cd ..

# å¼€å‘ç¯å¢ƒå¯åŠ¨ (ä½¿ç”¨ testweb_dev æ•°æ®åº“)
npm start

# ç”Ÿäº§ç¯å¢ƒå¯åŠ¨ (ä½¿ç”¨ testweb_prod æ•°æ®åº“)
NODE_ENV=production npm start
```

è¯¦ç»†å¯åŠ¨æŒ‡å—è¯·å‚è€ƒ: [STARTUP_GUIDE.md](../STARTUP_GUIDE.md)

## ğŸ³ Docker éƒ¨ç½²

### ä½¿ç”¨Docker Compose
```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f api
```

### å•ç‹¬æ„å»ºAPIæœåŠ¡
```bash
# æ„å»ºé•œåƒ
npm run docker:build

# è¿è¡Œå®¹å™¨
npm run docker:run
```

## ğŸ“Š API æ–‡æ¡£

### å¥åº·æ£€æŸ¥
```
GET /health
```

### APIä¿¡æ¯
```
GET /api/info
```

### è®¤è¯ç›¸å…³
```
POST /api/auth/register    # ç”¨æˆ·æ³¨å†Œ
POST /api/auth/login       # ç”¨æˆ·ç™»å½•
POST /api/auth/refresh     # åˆ·æ–°ä»¤ç‰Œ
POST /api/auth/logout      # ç”¨æˆ·ç™»å‡º
```

### æµ‹è¯•ç›¸å…³
```
POST /api/tests/performance    # æ€§èƒ½æµ‹è¯•
POST /api/tests/ux            # UXæµ‹è¯•
POST /api/tests/compatibility # å…¼å®¹æ€§æµ‹è¯•
POST /api/tests/security      # å®‰å…¨æµ‹è¯•
POST /api/tests/seo           # SEOæµ‹è¯•
```

### æµ‹è¯•å¼•æ“
```
GET  /api/test-engines/status           # å¼•æ“çŠ¶æ€
POST /api/test-engines/k6/run          # K6æµ‹è¯•
POST /api/test-engines/lighthouse/run  # Lighthouseæµ‹è¯•
POST /api/test-engines/playwright/run  # Playwrightæµ‹è¯•
```

## ğŸ”§ å¼€å‘æŒ‡å—

### ä»£ç è§„èŒƒ
- ä½¿ç”¨ESLintè¿›è¡Œä»£ç æ£€æŸ¥
- éµå¾ªJavaScript Standard Style
- ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

### æµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# ç›‘å¬æ¨¡å¼
npm run test:watch

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage
```

### ä»£ç æ£€æŸ¥
```bash
# æ£€æŸ¥ä»£ç è§„èŒƒ
npm run lint

# è‡ªåŠ¨ä¿®å¤
npm run lint:fix
```

## ğŸ“ˆ ç›‘æ§å’Œæ—¥å¿—

### æ—¥å¿—é…ç½®
- ä½¿ç”¨Winstonè¿›è¡Œç»“æ„åŒ–æ—¥å¿—è®°å½•
- æ”¯æŒå¤šç§æ—¥å¿—çº§åˆ«å’Œè¾“å‡ºæ ¼å¼
- ç”Ÿäº§ç¯å¢ƒæ—¥å¿—è½®è½¬

### æ€§èƒ½ç›‘æ§
- é›†æˆPrometheusæŒ‡æ ‡æ”¶é›†
- æ”¯æŒè‡ªå®šä¹‰ä¸šåŠ¡æŒ‡æ ‡
- å¥åº·æ£€æŸ¥ç«¯ç‚¹

## ğŸ”’ å®‰å…¨ç‰¹æ€§

### è®¤è¯å’Œæˆæƒ
- JWTä»¤ç‰Œè®¤è¯
- è§’è‰²åŸºç¡€è®¿é—®æ§åˆ¶
- APIå¯†é’¥ç®¡ç†

### å®‰å…¨é˜²æŠ¤
- è¯·æ±‚é€Ÿç‡é™åˆ¶
- CORSè·¨åŸŸä¿æŠ¤
- å®‰å…¨å¤´è®¾ç½®
- è¾“å…¥éªŒè¯å’Œæ¸…ç†

## ğŸš€ éƒ¨ç½²å’Œè¿ç»´

### ç”Ÿäº§éƒ¨ç½²
1. æ„å»ºDockeré•œåƒ
2. é…ç½®ç¯å¢ƒå˜é‡
3. è¿è¡Œæ•°æ®åº“è¿ç§»
4. å¯åŠ¨æœåŠ¡å®¹å™¨
5. é…ç½®è´Ÿè½½å‡è¡¡å™¨

### ç›‘æ§å’Œå‘Šè­¦
- åº”ç”¨æ€§èƒ½ç›‘æ§
- é”™è¯¯æ—¥å¿—æ”¶é›†
- èµ„æºä½¿ç”¨ç›‘æ§
- è‡ªåŠ¨å‘Šè­¦é€šçŸ¥

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤ä»£ç å˜æ›´
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»ºPull Request

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](../LICENSE) æ–‡ä»¶

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š
- æäº¤Issue
- å‘é€é‚®ä»¶è‡³ xyd91964208@gamil.com
- æŸ¥çœ‹æ–‡æ¡£ https://docs.testweb.app
