# å¤šç‰ˆæœ¬é—®é¢˜åˆ†ææŠ¥å‘Š

**ç”Ÿæˆæ—¥æœŸ**: 2025-10-03  
**æ£€æŸ¥æ—¶é—´**: 15:50  
**é¡¹ç›®**: Test-Web  
**åˆ†æèŒƒå›´**: ä¾èµ–ç‰ˆæœ¬å†²çª + APIç‰ˆæœ¬ç®¡ç† + Node.jså…¼å®¹æ€§  

---

## ğŸ“Š **æ‰§è¡Œæ‘˜è¦**

å¯¹Test-Webé¡¹ç›®è¿›è¡Œäº†å…¨é¢çš„ç‰ˆæœ¬å†²çªå’Œå…¼å®¹æ€§åˆ†æï¼Œå‘ç°äº†**ä¸¥é‡çš„ä¾èµ–ç‰ˆæœ¬å†²çªé—®é¢˜**ã€‚

### å…³é”®å‘ç°

| é—®é¢˜ç±»å‹ | æ•°é‡ | ä¸¥é‡ç¨‹åº¦ | çŠ¶æ€ |
|---------|------|---------|------|
| **ä¸¥é‡ç‰ˆæœ¬å†²çª** | 2ä¸ª | ğŸ”´ é«˜ | å¿…é¡»ä¿®å¤ |
| **Electronç‰ˆæœ¬ä¸ä¸€è‡´** | 2å¤„ | ğŸŸ¡ ä¸­ç­‰ | å»ºè®®ç»Ÿä¸€ |
| **Node.jsç‰ˆæœ¬ä¸å…¼å®¹** | 1å¤„ | ğŸŸ¡ ä¸­ç­‰ | éœ€è¦éªŒè¯ |
| **é‡å¤ä¾èµ–** | å¤šä¸ª | ğŸŸ¢ ä½ | å¯ä¼˜åŒ– |
| **APIç‰ˆæœ¬ç®¡ç†** | æ­£å¸¸ | âœ… è‰¯å¥½ | æ— é—®é¢˜ |

---

## ğŸ”´ **ä¸¥é‡é—®é¢˜ï¼ˆå¿…é¡»ä¿®å¤ï¼‰**

### é—®é¢˜ 1: `glob` ç‰ˆæœ¬å†²çª âš ï¸ **CRITICAL**

**é—®é¢˜æè¿°**:
```
npm error invalid: glob@10.4.5
Expected: ^11.0.3
Actual: 10.4.5
```

**æ ¹æœ¬åŸå› **:
- **æ ¹ package.json** è¦æ±‚ `glob@^11.0.3`ï¼ˆåœ¨ `resolutions` å­—æ®µä¸­ï¼‰
- **å®é™…å®‰è£…** çš„æ˜¯ `glob@10.4.5`ï¼ˆå‘ä¸‹å…¼å®¹æ€§å¯¼è‡´ï¼‰
- **å¤šä¸ªä¾èµ–** é—´æ¥ä¾èµ–ä¸åŒç‰ˆæœ¬çš„ glob

**å½±å“èŒƒå›´**:
```
å—å½±å“çš„åŒ…ï¼ˆéƒ¨åˆ†ï¼‰ï¼š
â”œâ”€â”€ electron-builder@25.1.8
â”‚   â””â”€â”€ ä¾èµ– glob@^7.1.4 æˆ– ^10.x
â”œâ”€â”€ rimraf@5.0.10
â”‚   â””â”€â”€ ä¾èµ– glob@^10.x
â”œâ”€â”€ tailwindcss@3.4.17
â”‚   â””â”€â”€ é—´æ¥ä¾èµ– glob
â”œâ”€â”€ archiver@7.0.1 (backend)
â”‚   â””â”€â”€ ä¾èµ– glob@^8.0.0
â”œâ”€â”€ jest@29.7.0 (backend)
â”‚   â””â”€â”€ ä¾èµ– glob@^7.1.3
â””â”€â”€ swagger-jsdoc@6.2.8 (backend)
    â””â”€â”€ ä¾èµ– glob@7.1.6 (å›ºå®šç‰ˆæœ¬ï¼)
```

**ç‰ˆæœ¬å†²çªè¯¦æƒ…**:
| åŒ… | éœ€è¦çš„ç‰ˆæœ¬ | å®é™…ç‰ˆæœ¬ | å…¼å®¹æ€§ |
|----|-----------|---------|--------|
| root (resolutions) | `^11.0.3` | 10.4.5 | âŒ ä¸å…¼å®¹ |
| swagger-jsdoc | `7.1.6` | 10.4.5 | âŒ ä¸å…¼å®¹ |
| archiver-utils | `^8.0.0` | 10.4.5 | âš ï¸ é™çº§ |
| jest ç›¸å…³ | `^7.1.3` | 10.4.5 | âœ… å‘ä¸Šå…¼å®¹ |

**ä¿®å¤æ–¹æ¡ˆ**:

#### æ–¹æ¡ˆ A: å›é€€åˆ° glob@10.xï¼ˆæ¨èï¼‰
```json
// package.json
{
  "resolutions": {
    "glob": "^10.3.0"  // ä» ^11.0.3 æ”¹ä¸º ^10.3.0
  }
}
```

**ä¼˜ç‚¹**: 
- âœ… ç«‹å³è§£å†³å†²çª
- âœ… ä¸æ‰€æœ‰ç°æœ‰ä¾èµ–å…¼å®¹
- âœ… ä¸éœ€è¦ä¿®æ”¹å…¶ä»–åŒ…

**ç¼ºç‚¹**:
- âš ï¸ ä¸ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬

#### æ–¹æ¡ˆ B: å‡çº§åˆ° glob@11.xï¼ˆé•¿æœŸæ–¹æ¡ˆï¼‰
```json
// package.json
{
  "resolutions": {
    "glob": "^11.0.3",  // ä¿æŒ
    "swagger-jsdoc": "^7.2.0"  // å‡çº§ swagger-jsdoc
  }
}
```

ç„¶åè¿è¡Œ:
```bash
npm install --legacy-peer-deps
```

**ä¼˜ç‚¹**:
- âœ… ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬
- âœ… è·å¾—æ–°åŠŸèƒ½å’Œæ€§èƒ½æ”¹è¿›

**ç¼ºç‚¹**:
- âš ï¸ å¯èƒ½éœ€è¦ä¿®æ”¹å¤šä¸ªä¾èµ–åŒ…
- âš ï¸ swagger-jsdoc@6.2.8 å›ºå®šä¾èµ– glob@7.1.6
- âš ï¸ éœ€è¦æµ‹è¯•å‘ä¸‹å…¼å®¹æ€§

---

### é—®é¢˜ 2: `@types/node` ç‰ˆæœ¬å†²çª âš ï¸ **CRITICAL**

**é—®é¢˜æè¿°**:
```
npm error invalid: @types/node@24.5.2
Expected: ^20.0.0 (from shared & backend)
Expected: ^20.9.0 (from electron@32.x)
Expected: ^18.11.18 (from electron@28.x in tools/electron)
Actual: 24.5.2
```

**æ ¹æœ¬åŸå› **:
- **å¤šä¸ª package.json** è¦æ±‚ä¸åŒç‰ˆæœ¬çš„ `@types/node`
- **npm** å®‰è£…äº†æœ€æ–°çš„ `24.5.2`ï¼Œä½†ä¸æ»¡è¶³æŸäº›åŒ…çš„è¦æ±‚

**è¯¦ç»†ç‰ˆæœ¬è¦æ±‚**:

| ä½ç½® | è¦æ±‚ç‰ˆæœ¬ | å®é™…ç‰ˆæœ¬ | çŠ¶æ€ |
|------|---------|---------|------|
| **backend/package.json** | `^20.0.0` | 24.5.2 | âŒ ä¸åŒ¹é… |
| **shared/package.json** | `^20.0.0` | 24.5.2 | âŒ ä¸åŒ¹é… |
| **electron@32.3.3** | `^20.9.0` | 24.5.2 | âš ï¸ å‘ä¸Šå…¼å®¹ |
| **tools/electron (electron@28)** | `^18.11.18` | 24.5.2 | âš ï¸ å‘ä¸Šå…¼å®¹ |
| **docx@8.6.0** | `^20.3.1` | 24.5.2 | âš ï¸ å‘ä¸Šå…¼å®¹ |

**å½±å“**:
- âœ… è¿è¡Œæ—¶å¯èƒ½æ­£å¸¸å·¥ä½œï¼ˆå‘ä¸Šå…¼å®¹ï¼‰
- âŒ npm æ˜¾ç¤ºé”™è¯¯è­¦å‘Š
- âš ï¸ TypeScript ç±»å‹å®šä¹‰å¯èƒ½ä¸ä¸€è‡´
- âš ï¸ æ–°ç‰ˆæœ¬å¯èƒ½åŒ…å«ç ´åæ€§å˜æ›´

**ä¿®å¤æ–¹æ¡ˆ**:

#### æ–¹æ¡ˆ A: ç»Ÿä¸€åˆ° @types/node@20.xï¼ˆæ¨èï¼‰
```json
// package.json (root)
{
  "resolutions": {
    "@types/node": "^20.10.0"  // ç»Ÿä¸€åˆ° 20.x æœ€æ–°ç‰ˆæœ¬
  }
}

// backend/package.json
{
  "devDependencies": {
    "@types/node": "^20.10.0"  // æ˜ç¡®æŒ‡å®š 20.x
  }
}

// shared/package.json
{
  "devDependencies": {
    "@types/node": "^20.10.0"  // æ˜ç¡®æŒ‡å®š 20.x
  }
}
```

**åŸå› **:
- âœ… æ»¡è¶³æ‰€æœ‰ package.json çš„è¦æ±‚ï¼ˆ`^20.0.0`ï¼‰
- âœ… å‘åå…¼å®¹ electron@28 çš„è¦æ±‚ï¼ˆ`^18.x`ï¼‰
- âœ… ç¨³å®šçš„LTSç‰ˆæœ¬

#### æ–¹æ¡ˆ B: å‡çº§åˆ° @types/node@24.x
```json
// backend/package.json
{
  "devDependencies": {
    "@types/node": "^24.0.0"  // å‡çº§åˆ° 24.x
  }
}

// shared/package.json
{
  "devDependencies": {
    "@types/node": "^24.0.0"  // å‡çº§åˆ° 24.x
  }
}

// tools/electron/package.json
{
  "devDependencies": {
    "@types/node": "^24.0.0"  // å‡çº§ electron åˆ° 32.x æˆ–æ¥å—ç‰ˆæœ¬å·®å¼‚
  }
}
```

**é£é™©**:
- âš ï¸ éœ€è¦éªŒè¯æ‰€æœ‰ TypeScript ä»£ç 
- âš ï¸ å¯èƒ½å­˜åœ¨ç±»å‹å®šä¹‰ç ´åæ€§å˜æ›´
- âš ï¸ Node.js 24.x ç±»å‹å¯èƒ½ä¸å…¼å®¹ Node.js 18/20

---

## ğŸŸ¡ **ä¸­ç­‰ä¼˜å…ˆçº§é—®é¢˜**

### é—®é¢˜ 3: Electron ç‰ˆæœ¬ä¸ä¸€è‡´

**é—®é¢˜æè¿°**:
- **æ ¹é¡¹ç›®** (`package.json`): `electron@^32.2.6` â†’ å®é™…å®‰è£… `32.3.3`
- **tools/electron** (`tools/electron/package.json`): `electron@^28.0.0` â†’ å®é™…å®‰è£… `28.3.3`

**ç‰ˆæœ¬å¯¹æ¯”**:
```
æ ¹é¡¹ç›® (package.json):
  "electron": "^32.2.6"      âœ… æœ€æ–°ç¨³å®šç‰ˆ (2024-10)

tools/electron å­é¡¹ç›® (tools/electron/package.json):
  "electron": "^28.0.0"      âš ï¸ æ—§ç‰ˆæœ¬ (2024-03)
```

**ç‰ˆæœ¬å·®å¼‚å½±å“**:
| ç‰¹æ€§ | Electron 28 | Electron 32 | å…¼å®¹æ€§ |
|------|------------|------------|--------|
| Chromium ç‰ˆæœ¬ | 120.x | 128.x | âš ï¸ ä¸åŒ |
| Node.js ç‰ˆæœ¬ | 18.18.x | 20.11.x | âš ï¸ ä¸åŒ |
| V8 å¼•æ“ | 12.0.x | 12.8.x | âš ï¸ ä¸åŒ |
| å®‰å…¨æ›´æ–° | æ—§ | æ–° | âœ… 32æ›´å¥½ |
| API å˜æ›´ | - | å¤šå¤„ | âš ï¸ éœ€è¦æµ‹è¯• |

**æ½œåœ¨é—®é¢˜**:
1. **Node.js ç‰ˆæœ¬ä¸åŒ**
   - Electron 28 ä½¿ç”¨ Node.js 18.x
   - Electron 32 ä½¿ç”¨ Node.js 20.x
   - å¯èƒ½å½±å“åŸç”Ÿæ¨¡å—å…¼å®¹æ€§

2. **Chromium ç‰ˆæœ¬å·®å¼‚**
   - æ¸²æŸ“è¡Œä¸ºå¯èƒ½ä¸åŒ
   - CSS/JSç‰¹æ€§æ”¯æŒä¸åŒ

3. **ä¾èµ–å†²çª**
   - `@types/node` ç‰ˆæœ¬è¦æ±‚ä¸åŒ
   - `electron-builder` ç‰ˆæœ¬ä¸åŒï¼ˆ24.x vs 25.xï¼‰

**ä¿®å¤æ–¹æ¡ˆ**:

#### æ–¹æ¡ˆ A: ç»Ÿä¸€åˆ° Electron 32.xï¼ˆæ¨èï¼‰
```json
// tools/electron/package.json
{
  "dependencies": {
    "electron": "^32.2.6"  // ä» ^28.0.0 å‡çº§
  },
  "devDependencies": {
    "electron-builder": "^25.1.8"  // ä» ^24.9.1 å‡çº§
  }
}
```

**æ­¥éª¤**:
1. æ›´æ–° `tools/electron/package.json`
2. è¿è¡Œ `npm install` åœ¨ tools/electron ç›®å½•
3. æµ‹è¯• Electron åº”ç”¨å¯åŠ¨å’ŒåŠŸèƒ½
4. æ£€æŸ¥åŸç”Ÿæ¨¡å—å…¼å®¹æ€§ï¼ˆsqlite3, better-sqlite3, canvasç­‰ï¼‰

**ä¼˜ç‚¹**:
- âœ… ç»Ÿä¸€ç‰ˆæœ¬ï¼Œé¿å…æ··æ·†
- âœ… ä½¿ç”¨æœ€æ–°å®‰å…¨è¡¥ä¸
- âœ… è·å¾—æ–°åŠŸèƒ½å’Œæ€§èƒ½æ”¹è¿›

**ç¼ºç‚¹**:
- âš ï¸ éœ€è¦æµ‹è¯•å…¼å®¹æ€§
- âš ï¸ å¯èƒ½éœ€è¦é‡æ–°ç¼–è¯‘åŸç”Ÿæ¨¡å—

#### æ–¹æ¡ˆ B: ä¿æŒåŒç‰ˆæœ¬ï¼ˆä¸´æ—¶æ–¹æ¡ˆï¼‰
ä¿æŒå½“å‰é…ç½®ï¼Œä½†éœ€è¦ï¼š
1. æ˜ç¡®æ–‡æ¡£è¯´æ˜ç‰ˆæœ¬å·®å¼‚
2. ç¡®ä¿ä¸¤ä¸ªç‰ˆæœ¬çš„åŠŸèƒ½ä¸€è‡´æ€§
3. å®šæœŸåŒæ­¥æ›´æ–°

**ä¸æ¨èåŸå› **:
- âŒ ç»´æŠ¤æˆæœ¬é«˜
- âŒ å®¹æ˜“äº§ç”Ÿbug
- âŒ æ··æ·†å¼€å‘è€…

---

### é—®é¢˜ 4: Node.js ç‰ˆæœ¬è¶…å‡ºè¦æ±‚

**ç¯å¢ƒæ£€æŸ¥**:
```
ç³»ç»Ÿå®‰è£…ç‰ˆæœ¬:
  Node.js: v22.16.0    âœ…
  npm: 11.4.1          âœ…

é¡¹ç›®è¦æ±‚ (engines):
  backend/package.json:  node >=18.0.0, npm >=9.0.0   âœ… å…¼å®¹
  frontend/package.json: node >=18.0.0, npm >=9.0.0   âœ… å…¼å®¹
  tools/electron:        node >=18.0.0, npm >=8.0.0   âœ… å…¼å®¹
```

**åˆ†æ**:
- âœ… **Node.js 22.16.0** æ»¡è¶³æ‰€æœ‰ `>=18.0.0` çš„è¦æ±‚
- âœ… **npm 11.4.1** æ»¡è¶³æ‰€æœ‰ `>=8.0.0` çš„è¦æ±‚
- âš ï¸ ä½† **Node.js 22** æ˜¯**å½“å‰å¼€å‘ç‰ˆ**ï¼ˆé LTSï¼‰ï¼Œå¯èƒ½ä¸ç¨³å®š

**Node.js ç‰ˆæœ¬å¯¹æ¯”**:
| ç‰ˆæœ¬ | çŠ¶æ€ | LTS? | ç»“æŸæ—¥æœŸ | æ¨èï¼Ÿ |
|------|------|------|----------|--------|
| **18.x** | Active LTS | âœ… Yes | 2025-04 | âœ… æ¨è |
| **20.x** | Active LTS | âœ… Yes | 2026-04 | âœ… æ¨è |
| **22.x** | Current | âŒ No | 2025-10 | âš ï¸ å¼€å‘ç”¨ |

**æ½œåœ¨é£é™©**:
1. Node.js 22 å¯èƒ½å­˜åœ¨æœªçŸ¥bug
2. æŸäº›åŸç”Ÿæ¨¡å—å¯èƒ½æœªå®Œå…¨æ”¯æŒ Node.js 22
3. ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ LTS ç‰ˆæœ¬

**å»ºè®®**:
```bash
# å»ºè®®ä½¿ç”¨ Node.js 20.x LTS
nvm install 20
nvm use 20

# æˆ–ä½¿ç”¨ Node.js 18.x LTS
nvm install 18
nvm use 18
```

**æ›´æ–° engines å­—æ®µï¼ˆå¯é€‰ï¼‰**:
```json
// æ‰€æœ‰ package.json
{
  "engines": {
    "node": ">=18.0.0 <23.0.0",  // é™åˆ¶æœ€é«˜ç‰ˆæœ¬
    "npm": ">=9.0.0"
  }
}
```

---

## ğŸŸ¢ **ä½ä¼˜å…ˆçº§é—®é¢˜ï¼ˆå¯ä¼˜åŒ–ï¼‰**

### é—®é¢˜ 5: é‡å¤ä¾èµ–

**æ£€æµ‹åˆ°çš„é‡å¤ä¾èµ–**:
```
1. axios:
   - æ ¹é¡¹ç›®: ^1.11.0 â†’ å®é™… 1.12.2
   - frontend: ^1.11.0 â†’ å®é™… 1.12.2 (deduped)
   - backend: ^1.11.0 â†’ å®é™… 1.12.2 (deduped)
   âœ… å·²å»é‡

2. date-fns:
   - æ ¹é¡¹ç›®: ^4.1.0
   - frontend: ^4.1.0 (deduped)
   - backend: ^4.1.0 (deduped)
   âœ… å·²å»é‡

3. react:
   - æ ¹é¡¹ç›®: ^18.2.0 â†’ å®é™… 18.3.1
   - frontend: ^18.2.0 â†’ å®é™… 18.3.1 (deduped)
   âœ… å·²å»é‡

4. chart.js:
   - æ ¹é¡¹ç›®: ^4.5.0
   - frontend: ^4.5.0 (deduped)
   - tools/electron: ^4.4.1 â†’ å®é™… 4.5.0 (deduped)
   âœ… å·²å»é‡ä½†ç‰ˆæœ¬ç•¥æœ‰å·®å¼‚

5. winston:
   - backend: ^3.17.0
   - tools/electron: ^3.11.0 â†’ å®é™… 3.17.0 (deduped)
   âœ… å·²å»é‡
```

**æ€»ç»“**:
- âœ… **npm workspace æœºåˆ¶æ­£å¸¸å·¥ä½œ**ï¼Œå¤§éƒ¨åˆ†ä¾èµ–å·²è‡ªåŠ¨å»é‡
- âš ï¸ æŸäº›åŒ…å­˜åœ¨**æ¬¡è¦ç‰ˆæœ¬å·®å¼‚**ä½†è¢«è‡ªåŠ¨ç»Ÿä¸€
- ğŸŸ¢ **ä¸éœ€è¦ç«‹å³ä¿®å¤**ï¼Œä½†å¯å®šæœŸæ¸…ç†

**ä¼˜åŒ–å»ºè®®**:
```json
// ç»Ÿä¸€æ‰€æœ‰å­é¡¹ç›®çš„ç‰ˆæœ¬å£°æ˜
// tools/electron/package.json
{
  "dependencies": {
    "chart.js": "^4.5.0",    // ä» ^4.4.1 æ”¹ä¸º ^4.5.0
    "winston": "^3.17.0"     // ä» ^3.11.0 æ”¹ä¸º ^3.17.0
  }
}
```

---

### é—®é¢˜ 6: electron-builder ç‰ˆæœ¬ä¸ä¸€è‡´

**å½“å‰çŠ¶æ€**:
- **æ ¹é¡¹ç›®**: `electron-builder@^25.1.8` â†’ å®é™… 25.1.8
- **tools/electron**: `electron-builder@^24.9.1` â†’ å®é™… 24.13.3

**ç‰ˆæœ¬å·®å¼‚**:
| åŠŸèƒ½ | v24.x | v25.x | å½±å“ |
|------|-------|-------|------|
| Electron æ”¯æŒ | æœ€é«˜ 28.x | æœ€é«˜ 32.x | âš ï¸ é‡è¦ |
| æ„å»ºé…ç½® | æ—§æ ¼å¼ | æ–°æ ¼å¼ | âš ï¸ å¯èƒ½ä¸å…¼å®¹ |
| ä¾èµ–é¡¹ | æ—§ç‰ˆæœ¬ | æ–°ç‰ˆæœ¬ | ğŸŸ¢ æ­£å¸¸ |

**å»ºè®®**:
```json
// tools/electron/package.json
{
  "devDependencies": {
    "electron-builder": "^25.1.8"  // ä» ^24.9.1 å‡çº§
  }
}
```

**æ³¨æ„**:
- âš ï¸ å‡çº§åéœ€è¦æµ‹è¯•æ„å»ºæµç¨‹
- âš ï¸ æ£€æŸ¥æ„å»ºé…ç½®æ–‡ä»¶æ˜¯å¦éœ€è¦ä¿®æ”¹
- âš ï¸ éªŒè¯æ‰“åŒ…åçš„åº”ç”¨æ˜¯å¦æ­£å¸¸è¿è¡Œ

---

## âœ… **æ— é—®é¢˜åŒºåŸŸ**

### API ç‰ˆæœ¬ç®¡ç† âœ…

**æ£€æŸ¥ç»“æœ**: **è‰¯å¥½** ğŸŸ¢

**RouteManager é…ç½®**:
```javascript
// backend/src/RouteManager.js
registerAPIVersions() {
  // v1 ç‰ˆæœ¬ - å½“å‰æ´»è·ƒ
  this.versions.set('v1', {
    version: 'v1',
    description: 'Initial API version',
    releaseDate: '2024-08-15',
    deprecated: false,
    routes: new Map()
  });

  // v2 ç‰ˆæœ¬ - é¢„ç•™
  this.versions.set('v2', {
    version: 'v2',
    description: 'Enhanced API version',
    releaseDate: '2024-12-01',
    deprecated: false,
    routes: new Map()
  });
}

config = {
  enableVersioning: true,
  defaultVersion: 'v1'
}
```

**è¯„ä¼°**:
- âœ… API ç‰ˆæœ¬ç®¡ç†æœºåˆ¶å·²å®ç°
- âœ… ç‰ˆæœ¬æ£€æµ‹ä¸­é—´ä»¶å·²é…ç½®
- âœ… å¼ƒç”¨æ ‡è®°æœºåˆ¶ï¼ˆX-API-Deprecated headerï¼‰
- âœ… v1 å’Œ v2 é¢„ç•™é…ç½®åˆç†
- âœ… é»˜è®¤ç‰ˆæœ¬è®¾ç½®ä¸º v1

**å»ºè®®**:
- ğŸŸ¢ å½“å‰æœºåˆ¶å®Œå–„ï¼Œæ— éœ€ä¿®æ”¹
- ğŸ“ ç¡®ä¿è·¯ç”±æ³¨å†Œæ—¶æ­£ç¡®æŒ‡å®šç‰ˆæœ¬
- ğŸ“ v2 å‘å¸ƒæ—¶æ›´æ–°æ–‡æ¡£

---

## ğŸ“‹ **ä¿®å¤ä¼˜å…ˆçº§å’Œæ‰§è¡Œè®¡åˆ’**

### ğŸš¨ **é˜¶æ®µ 1: ç´§æ€¥ä¿®å¤ï¼ˆå¿…é¡»å®Œæˆï¼‰**

#### ä¿®å¤ 1: è§£å†³ glob ç‰ˆæœ¬å†²çª

**æ¨èæ–¹æ¡ˆ**: å›é€€åˆ° glob@10.x

**æ­¥éª¤**:
```bash
# 1. ä¿®æ”¹ package.json
# å°† "glob": "^11.0.3" æ”¹ä¸º "glob": "^10.3.0"

# 2. åˆ é™¤ node_modules å’Œ lock æ–‡ä»¶
rm -rf node_modules package-lock.json

# 3. é‡æ–°å®‰è£…
npm install

# 4. éªŒè¯ç‰ˆæœ¬
npm ls glob
```

**é¢„æœŸç»“æœ**:
```
âœ… glob@10.4.5 å®‰è£…æˆåŠŸ
âœ… æ—  npm error invalid è­¦å‘Š
âœ… æ‰€æœ‰ä¾èµ–æ»¡è¶³è¦æ±‚
```

---

#### ä¿®å¤ 2: è§£å†³ @types/node ç‰ˆæœ¬å†²çª

**æ¨èæ–¹æ¡ˆ**: ç»Ÿä¸€åˆ° @types/node@20.x

**æ­¥éª¤**:

**2.1 ä¿®æ”¹æ ¹ package.json**:
```json
{
  "resolutions": {
    "@types/node": "^20.10.0"
  }
}
```

**2.2 ä¿®æ”¹ backend/package.json**:
```json
{
  "devDependencies": {
    "@types/node": "^20.10.0"
  }
}
```

**2.3 ä¿®æ”¹ shared/package.json**:
```json
{
  "devDependencies": {
    "@types/node": "^20.10.0"
  }
}
```

**2.4 é‡æ–°å®‰è£…**:
```bash
# åˆ é™¤æ—§çš„ä¾èµ–
rm -rf node_modules package-lock.json
rm -rf backend/node_modules backend/package-lock.json
rm -rf shared/node_modules shared/package-lock.json

# é‡æ–°å®‰è£…
npm install

# éªŒè¯ç‰ˆæœ¬
npm ls @types/node
```

**é¢„æœŸç»“æœ**:
```
âœ… @types/node@20.10.x å®‰è£…æˆåŠŸ
âœ… æ—  npm error invalid è­¦å‘Š
âœ… TypeScript ç¼–è¯‘æ­£å¸¸
```

---

### ğŸ“… **é˜¶æ®µ 2: é‡è¦ä¼˜åŒ–ï¼ˆæ¨èå®Œæˆï¼‰**

#### ä¿®å¤ 3: ç»Ÿä¸€ Electron ç‰ˆæœ¬åˆ° 32.x

**æ­¥éª¤**:

**3.1 ä¿®æ”¹ tools/electron/package.json**:
```json
{
  "dependencies": {
    "electron": "^32.2.6"
  },
  "devDependencies": {
    "electron-builder": "^25.1.8"
  }
}
```

**3.2 æ›´æ–°ä¾èµ–**:
```bash
cd tools/electron
npm install
cd ../..
```

**3.3 æµ‹è¯• Electron åº”ç”¨**:
```bash
npm run electron:dev
# éªŒè¯åº”ç”¨å¯åŠ¨æ­£å¸¸
# æµ‹è¯•ä¸»è¦åŠŸèƒ½
```

**3.4 é‡æ–°æ„å»ºåŸç”Ÿæ¨¡å—ï¼ˆå¦‚æœéœ€è¦ï¼‰**:
```bash
cd tools/electron
npm rebuild
```

---

#### ä¿®å¤ 4: éªŒè¯ Node.js ç‰ˆæœ¬å…¼å®¹æ€§

**æ­¥éª¤**:

**4.1 æ£€æŸ¥å½“å‰ç‰ˆæœ¬**:
```bash
node --version  # v22.16.0
npm --version   # 11.4.1
```

**4.2 å¯é€‰ï¼šåˆ‡æ¢åˆ° LTS ç‰ˆæœ¬**:
```bash
# ä½¿ç”¨ nvmï¼ˆæ¨èï¼‰
nvm install 20
nvm use 20

# æˆ–ä½¿ç”¨ n
n lts
```

**4.3 é‡æ–°æµ‹è¯•é¡¹ç›®**:
```bash
# å‰ç«¯
npm run dev

# åç«¯
npm run backend:dev

# æµ‹è¯•
npm run test
```

---

### ğŸ”§ **é˜¶æ®µ 3: é•¿æœŸç»´æŠ¤ï¼ˆå¯é€‰ï¼‰**

#### ä¼˜åŒ– 1: ç»Ÿä¸€æ¬¡è¦ç‰ˆæœ¬

**æ­¥éª¤**:
```json
// tools/electron/package.json
{
  "dependencies": {
    "chart.js": "^4.5.0",
    "winston": "^3.17.0",
    "playwright": "^1.55.1",
    "puppeteer": "^24.22.3"
  }
}
```

#### ä¼˜åŒ– 2: æ·»åŠ ç‰ˆæœ¬æ£€æŸ¥è„šæœ¬

åˆ›å»º `scripts/check-versions.js`:
```javascript
#!/usr/bin/env node
const { execSync } = require('child_process');

console.log('ğŸ” æ£€æŸ¥ç‰ˆæœ¬å†²çª...\n');

// æ£€æŸ¥ glob
console.log('ğŸ“¦ glob:');
execSync('npm ls glob', { stdio: 'inherit' });

// æ£€æŸ¥ @types/node
console.log('\nğŸ“¦ @types/node:');
execSync('npm ls @types/node', { stdio: 'inherit' });

// æ£€æŸ¥ electron
console.log('\nğŸ“¦ electron:');
execSync('npm ls electron', { stdio: 'inherit' });

console.log('\nâœ… ç‰ˆæœ¬æ£€æŸ¥å®Œæˆ');
```

æ·»åŠ åˆ° package.json:
```json
{
  "scripts": {
    "check:versions": "node scripts/check-versions.js"
  }
}
```

#### ä¼˜åŒ– 3: å®šæœŸæ›´æ–°ä¾èµ–

```bash
# æ£€æŸ¥è¿‡æœŸä¾èµ–
npm outdated

# æ›´æ–°æ¬¡è¦ç‰ˆæœ¬
npm update

# æ›´æ–°ä¸»è¦ç‰ˆæœ¬ï¼ˆè°¨æ…ï¼‰
npm install <package>@latest
```

---

## ğŸ§ª **éªŒè¯æ¸…å•**

ä¿®å¤åéœ€è¦éªŒè¯ï¼š

### âœ… ä¾èµ–ç‰ˆæœ¬
- [ ] `npm ls glob` æ— é”™è¯¯
- [ ] `npm ls @types/node` æ— é”™è¯¯
- [ ] `npm install` æ— è­¦å‘Š
- [ ] `npm list --depth=0` æ—  invalid æ ‡è®°

### âœ… ç¼–è¯‘å’Œæ„å»º
- [ ] `npm run type-check` é€šè¿‡
- [ ] `npm run build` æˆåŠŸ
- [ ] `npm run backend:dev` å¯åŠ¨æ­£å¸¸
- [ ] `npm run frontend` å¯åŠ¨æ­£å¸¸

### âœ… æµ‹è¯•
- [ ] `npm run test` é€šè¿‡
- [ ] `npm run e2e` é€šè¿‡
- [ ] Electron åº”ç”¨å¯åŠ¨æ­£å¸¸
- [ ] Electron åº”ç”¨åŠŸèƒ½æ­£å¸¸

### âœ… ç‰ˆæœ¬ä¸€è‡´æ€§
- [ ] æ‰€æœ‰å­é¡¹ç›®çš„ Node.js ç‰ˆæœ¬è¦æ±‚ä¸€è‡´
- [ ] Electron ç‰ˆæœ¬åœ¨æ‰€æœ‰ä½ç½®ä¸€è‡´
- [ ] electron-builder ç‰ˆæœ¬åŒ¹é… Electron ç‰ˆæœ¬

---

## ğŸ“Š **ä¾èµ–ç‰ˆæœ¬æ±‡æ€»è¡¨**

### å…³é”®ä¾èµ–å½“å‰çŠ¶æ€

| åŒ…å | æ ¹é¡¹ç›® | Frontend | Backend | tools/electron | çŠ¶æ€ |
|------|--------|----------|---------|----------------|------|
| **glob** | resolutions: ^11.0.3 | - | - | - | ğŸ”´ å†²çª |
| **@types/node** | - | - | ^20.0.0 | - | ğŸ”´ å†²çª |
| **electron** | ^32.2.6 | - | - | ^28.0.0 | ğŸŸ¡ ä¸ä¸€è‡´ |
| **electron-builder** | ^25.1.8 | - | - | ^24.9.1 | ğŸŸ¡ ä¸ä¸€è‡´ |
| **axios** | ^1.11.0 | ^1.11.0 | ^1.11.0 | - | âœ… ä¸€è‡´ |
| **react** | ^18.2.0 | ^18.2.0 | - | - | âœ… ä¸€è‡´ |
| **typescript** | ^5.9.2 | ^5.9.2 | - | - | âœ… ä¸€è‡´ |
| **chart.js** | ^4.5.0 | ^4.5.0 | - | ^4.4.1 | ğŸŸ¢ æ¬¡è¦å·®å¼‚ |

### æ¨èç›®æ ‡ç‰ˆæœ¬

| åŒ…å | æ¨èç‰ˆæœ¬ | åŸå›  |
|------|---------|------|
| **glob** | `^10.4.5` | å…¼å®¹æ‰€æœ‰ç°æœ‰ä¾èµ– |
| **@types/node** | `^20.10.0` | æ»¡è¶³æ‰€æœ‰é¡¹ç›®è¦æ±‚ |
| **electron** | `^32.2.6` | æœ€æ–°ç¨³å®šç‰ˆ |
| **electron-builder** | `^25.1.8` | åŒ¹é… Electron 32 |
| **Node.js** | `20.x LTS` | ç¨³å®šçš„ LTS ç‰ˆæœ¬ |

---

## ğŸ¯ **æ€»ç»“å’Œå»ºè®®**

### ğŸ”´ **å¿…é¡»ç«‹å³ä¿®å¤**:
1. âœ… **glob ç‰ˆæœ¬å†²çª** - å›é€€åˆ° glob@10.x
2. âœ… **@types/node ç‰ˆæœ¬å†²çª** - ç»Ÿä¸€åˆ° @types/node@20.x

### ğŸŸ¡ **å»ºè®®çŸ­æœŸå®Œæˆ**:
3. âš ï¸ **ç»Ÿä¸€ Electron ç‰ˆæœ¬** - å‡çº§ tools/electron åˆ° Electron 32
4. âš ï¸ **éªŒè¯ Node.js ç‰ˆæœ¬** - å»ºè®®ä½¿ç”¨ Node.js 20.x LTS

### ğŸŸ¢ **å¯é€‰é•¿æœŸä¼˜åŒ–**:
5. ğŸ”§ ç»Ÿä¸€æ‰€æœ‰æ¬¡è¦ç‰ˆæœ¬å·®å¼‚
6. ğŸ”§ æ·»åŠ ç‰ˆæœ¬æ£€æŸ¥è„šæœ¬
7. ğŸ”§ å®šæœŸæ›´æ–°ä¾èµ–

### ğŸ“ˆ **é¢„æœŸæ”¹è¿›**:
å®Œæˆä¿®å¤åï¼š
- âœ… npm install æ— é”™è¯¯å’Œè­¦å‘Š
- âœ… æ‰€æœ‰ä¾èµ–ç‰ˆæœ¬ä¸€è‡´
- âœ… TypeScript ç±»å‹å®šä¹‰ç»Ÿä¸€
- âœ… Electron åº”ç”¨ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬
- âœ… å¼€å‘ä½“éªŒæ›´æµç•…

---

## ğŸš€ **å¿«é€Ÿä¿®å¤å‘½ä»¤**

**ä¸€é”®ä¿®å¤è„šæœ¬** (bash):
```bash
#!/bin/bash
echo "ğŸ”§ å¼€å§‹ä¿®å¤ç‰ˆæœ¬å†²çª..."

# 1. å¤‡ä»½å½“å‰é…ç½®
echo "ğŸ“¦ å¤‡ä»½é…ç½®..."
cp package.json package.json.backup
cp backend/package.json backend/package.json.backup
cp shared/package.json shared/package.json.backup

# 2. ä¿®å¤ glob ç‰ˆæœ¬ï¼ˆæ‰‹åŠ¨ç¼–è¾‘ package.json resolutionsï¼‰
echo "ğŸ”§ è¯·æ‰‹åŠ¨ä¿®æ”¹ package.json:"
echo "  å°† \"glob\": \"^11.0.3\" æ”¹ä¸º \"glob\": \"^10.3.0\""
read -p "å®ŒæˆåæŒ‰ Enter ç»§ç»­..."

# 3. ä¿®å¤ @types/node ç‰ˆæœ¬ï¼ˆæ‰‹åŠ¨ç¼–è¾‘ï¼‰
echo "ğŸ”§ è¯·æ‰‹åŠ¨ä¿®æ”¹ backend/package.json å’Œ shared/package.json:"
echo "  å°† \"@types/node\": \"^20.0.0\" ä¿æŒæˆ–æ”¹ä¸º \"^20.10.0\""
read -p "å®ŒæˆåæŒ‰ Enter ç»§ç»­..."

# 4. æ¸…ç†å¹¶é‡æ–°å®‰è£…
echo "ğŸ§¹ æ¸…ç†æ—§ä¾èµ–..."
rm -rf node_modules package-lock.json
rm -rf backend/node_modules
rm -rf shared/node_modules
rm -rf frontend/node_modules
rm -rf tools/electron/node_modules

echo "ğŸ“¦ é‡æ–°å®‰è£…ä¾èµ–..."
npm install

# 5. éªŒè¯
echo "âœ… éªŒè¯ç‰ˆæœ¬..."
npm ls glob
npm ls @types/node

echo "ğŸ‰ ä¿®å¤å®Œæˆï¼è¯·è¿è¡Œ 'npm run dev' æµ‹è¯•"
```

**Windows PowerShell ç‰ˆæœ¬**:
```powershell
# ç±»ä¼¼é€»è¾‘ï¼Œä½¿ç”¨ PowerShell å‘½ä»¤
```

---

**æŠ¥å‘Šç”Ÿæˆ**: Warp AI Agent  
**æœ€åæ›´æ–°**: 2025-10-03 15:50:00  
**çŠ¶æ€**: ğŸ”´ **éœ€è¦ä¿®å¤**  
**å»ºè®®**: **ç«‹å³ä¿®å¤ glob å’Œ @types/node ç‰ˆæœ¬å†²çª**

