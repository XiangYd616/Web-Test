# Test-Web é¡¹ç›®ç»“æ„åˆ†æä¸é”™è¯¯ä¿®æ­£æŠ¥å‘Š

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**é¡¹ç›®åç§°**: Test-Web  
**é¡¹ç›®ç±»å‹**: Monorepo æ¶æ„çš„è·¨å¹³å°Webæµ‹è¯•åº”ç”¨  
**æ¶æ„æ¨¡å¼**: å‰åç«¯åˆ†ç¦» + Electronæ¡Œé¢ç«¯  
**åŒ…ç®¡ç†å™¨**: Yarn Workspaces  

## ğŸ” é¡¹ç›®ç»“æ„åˆ†æ

### âœ… æ­£ç¡®çš„é…ç½®

1. **Monorepoå·¥ä½œç©ºé—´é…ç½®æ­£ç¡®**
   ```json
   "workspaces": [
     ".",
     "backend", 
     "shared",
     "tools/electron"
   ]
   ```

2. **TypeScripté…ç½®åˆç†**
   - ä¸¥æ ¼æ¨¡å¼å·²å¯ç”¨
   - è·¯å¾„æ˜ å°„é…ç½®å®Œæ•´
   - æ„å»ºç›®æ ‡è®¾ç½®åˆé€‚

3. **Viteæ„å»ºé…ç½®ä¼˜åŒ–**
   - ä»£ç åˆ†å‰²ç­–ç•¥è¯¦ç»†
   - æ€§èƒ½ä¼˜åŒ–é…ç½®å®Œå–„
   - ä»£ç†é…ç½®æ­£ç¡®

4. **æ ¸å¿ƒæ–‡ä»¶ç»“æ„å®Œæ•´**
   ```
   âœ… frontend/App.tsx - Reactä¸»åº”ç”¨
   âœ… frontend/main.tsx - å‰ç«¯å…¥å£
   âœ… frontend/index.html - HTMLæ¨¡æ¿
   âœ… backend/src/app.js - åç«¯APIæœåŠ¡
   âœ… tools/electron/main.js - Electronä¸»è¿›ç¨‹
   ```

## ğŸš¨ å‘ç°çš„é—®é¢˜

### 1. ä¾èµ–ç‰ˆæœ¬é—®é¢˜ (âš ï¸ é«˜ä¼˜å…ˆçº§)

**å®‰å…¨æ¼æ´è­¦å‘Š**:
```
- multer@1.4.5-lts.2: å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œéœ€å‡çº§åˆ°2.xç‰ˆæœ¬
- crypto@1.0.1: å·²è¿‡æ—¶ï¼Œåº”ä½¿ç”¨Node.jså†…ç½®æ¨¡å—
- puppeteer@21.11.0: ç‰ˆæœ¬è¿‡ä½ï¼Œéœ€å‡çº§åˆ° â‰¥24.10.2
- eslint@8.57.1: ä¸å†æ”¯æŒï¼Œéœ€å‡çº§
```

**ä¾èµ–å†²çª**:
```
- canvasç‰ˆæœ¬ä¸åŒ¹é…: jsdoméœ€è¦canvas@^3.0.0ï¼Œä½†å®‰è£…çš„æ˜¯@2.11.2
- å¤šä¸ªç‰ˆæœ¬ä¸åŒ¹é…é”™è¯¯å½±å“æµ‹è¯•ç¯å¢ƒ
```

### 2. åŒ…ç»“æ„é—®é¢˜

**ç¼ºå¤±çš„å‰ç«¯package.json**:
- `frontend/` ç›®å½•æ²¡æœ‰ç‹¬ç«‹çš„ `package.json`
- è¿™å¯¼è‡´å‰ç«¯ä¾èµ–ç®¡ç†æ··ä¹±
- å½±å“IDEæ”¯æŒå’Œæ„å»ºä¼˜åŒ–

**å…±äº«æ¨¡å—é…ç½®ä¸è¶³**:
```json
// shared/package.json è¿‡äºç®€å•
{
  "name": "test-web-shared",
  "version": "1.0.0", 
  "type": "commonjs",    // åº”è¯¥æ˜¯ "module"
  "main": "index.js"     // ç¼ºå°‘å¯¼å‡ºé…ç½®
}
```

### 3. æ„å»ºé…ç½®å†²çª

**é‡å¤çš„æ„å»ºé…ç½®**:
- æ ¹ç›®å½•å’Œ `tools/electron/` éƒ½æœ‰ electron-builder é…ç½®
- å¯èƒ½å¯¼è‡´æ„å»ºå†²çª

**è·¯å¾„æ˜ å°„ä¸ä¸€è‡´**:
- vite.config.ts ä¸­çš„è·¯å¾„æ˜ å°„ä¸å®é™…æ–‡ä»¶ç»“æ„æœ‰åå·®
- éƒ¨åˆ†åˆ«åè·¯å¾„å¯èƒ½æ— æ³•æ­£ç¡®è§£æ

## ğŸ› ï¸ ä¿®æ­£å»ºè®®

### 1. ä¾èµ–å®‰å…¨ä¿®æ­£ (ç«‹å³æ‰§è¡Œ)

```bash
# å‡çº§å®‰å…¨æ¼æ´ä¾èµ–
yarn workspace testweb-api-server add multer@^2.0.0
yarn workspace testweb-api-server remove crypto
yarn workspace test-web-app-desktop add puppeteer@^24.10.2
yarn add -D eslint@^9.0.0

# ä¿®å¤canvasç‰ˆæœ¬å†²çª
yarn add -D canvas@^3.0.0

# æ¸…ç†å¹¶é‡æ–°å®‰è£…ä¾èµ–
yarn clean:all
yarn install
```

### 2. é¡¹ç›®ç»“æ„ä¼˜åŒ–

**åˆ›å»ºfrontend/package.json**:
```json
{
  "name": "test-web-frontend",
  "version": "1.0.0",
  "type": "module",
  "private": true,
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview",
    "type-check": "tsc --noEmit"
  }
}
```

**ä¼˜åŒ–shared/package.json**:
```json
{
  "name": "test-web-shared",
  "version": "1.0.0",
  "type": "module",
  "private": true,
  "main": "index.js",
  "types": "index.d.ts",
  "exports": {
    ".": {
      "types": "./index.d.ts",
      "import": "./index.js"
    }
  }
}
```

### 3. é…ç½®æ–‡ä»¶ä¿®æ­£

**ä¿®æ­£vite.config.tsè·¯å¾„**:
```typescript
// ç¡®ä¿æ‰€æœ‰è·¯å¾„æ˜ å°„éƒ½æŒ‡å‘æ­£ç¡®çš„ç›®å½•
resolve: {
  alias: {
    '@': resolve(__dirname, 'frontend'),
    '@shared': resolve(__dirname, 'shared'),
    // éªŒè¯æ¯ä¸ªè·¯å¾„éƒ½å­˜åœ¨å¯¹åº”ç›®å½•
  }
}
```

**ç»Ÿä¸€æ„å»ºé…ç½®**:
```json
// å°†electronæ„å»ºé…ç½®ç»Ÿä¸€åˆ°æ ¹package.json
// ç§»é™¤tools/electron/package.jsonä¸­é‡å¤çš„buildé…ç½®
```

### 4. æ–‡ä»¶ç»“æ„å®Œå–„

**åˆ›å»ºç¼ºå¤±çš„å…¥å£æ–‡ä»¶**:
```bash
# shared/index.js - å…±äº«æ¨¡å—å…¥å£
# shared/index.d.ts - TypeScriptç±»å‹å®šä¹‰
# frontend/src/vite-env.d.ts - Viteç±»å‹å®šä¹‰
```

**æ¸…ç†ç©ºç›®å½•**:
```bash
# åˆ é™¤ç©ºçš„ç›®å½•
rmdir storage
rmdir task
# ä¿ç•™å¿…è¦çš„ç›®å½•ç»“æ„
```

## ğŸ“Š ä¿®æ­£ä¼˜å…ˆçº§

### ğŸ”´ é«˜ä¼˜å…ˆçº§ (å®‰å…¨ç›¸å…³)
1. **ä¾èµ–å®‰å…¨æ¼æ´ä¿®å¤** - ç«‹å³æ‰§è¡Œ
2. **ç‰ˆæœ¬å†²çªè§£å†³** - å½±å“æ„å»ºå’Œè¿è¡Œ

### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ (åŠŸèƒ½ç›¸å…³)  
3. **å‰ç«¯package.jsonåˆ›å»º** - æ”¹å–„å¼€å‘ä½“éªŒ
4. **è·¯å¾„æ˜ å°„ä¿®æ­£** - é¿å…å¯¼å…¥é”™è¯¯

### ğŸŸ¢ ä½ä¼˜å…ˆçº§ (ä¼˜åŒ–ç›¸å…³)
5. **ç©ºç›®å½•æ¸…ç†** - ä¿æŒé¡¹ç›®æ•´æ´
6. **æ„å»ºé…ç½®ç»Ÿä¸€** - æé«˜ç»´æŠ¤æ€§

## ğŸ¯ æ‰§è¡Œè®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µï¼šå®‰å…¨ä¿®å¤
```bash
# 1. å¤‡ä»½å½“å‰çŠ¶æ€
git add . && git commit -m "å¤‡ä»½å½“å‰é¡¹ç›®çŠ¶æ€"

# 2. ä¿®å¤ä¾èµ–å®‰å…¨é—®é¢˜
yarn workspace testweb-api-server add multer@^2.0.0
yarn workspace testweb-api-server remove crypto  
yarn workspace test-web-app-desktop add puppeteer@^24.10.2

# 3. éªŒè¯ä¿®å¤ç»“æœ
yarn check
```

### ç¬¬äºŒé˜¶æ®µï¼šç»“æ„ä¼˜åŒ–
```bash
# 1. åˆ›å»ºå‰ç«¯package.json
# 2. ä¼˜åŒ–sharedæ¨¡å—é…ç½®
# 3. ä¿®æ­£è·¯å¾„æ˜ å°„
# 4. æµ‹è¯•æ„å»ºæµç¨‹
```

### ç¬¬ä¸‰é˜¶æ®µï¼šæ¸…ç†ä¸éªŒè¯
```bash  
# 1. æ¸…ç†ç©ºç›®å½•
# 2. ç»Ÿä¸€é…ç½®æ–‡ä»¶
# 3. å…¨é¢æµ‹è¯•
yarn build && yarn test
```

## âœ… éªŒè¯æ¸…å•

- [ ] ä¾èµ–å®‰å…¨æ¼æ´å·²ä¿®å¤
- [ ] ç‰ˆæœ¬å†²çªå·²è§£å†³
- [ ] å‰ç«¯æœ‰ç‹¬ç«‹package.json
- [ ] è·¯å¾„æ˜ å°„é…ç½®æ­£ç¡®
- [ ] æ„å»ºæµç¨‹æ— é”™è¯¯
- [ ] ç±»å‹æ£€æŸ¥é€šè¿‡
- [ ] æµ‹è¯•æ­£å¸¸è¿è¡Œ

## ğŸ“ æ€»ç»“

**å½“å‰çŠ¶æ€**: é¡¹ç›®æ¶æ„åŸºç¡€è‰¯å¥½ï¼Œä½†å­˜åœ¨å®‰å…¨å’Œé…ç½®é—®é¢˜  
**ä¸»è¦é—®é¢˜**: ä¾èµ–å®‰å…¨æ¼æ´ã€ç‰ˆæœ¬å†²çªã€é…ç½®ä¸å®Œæ•´  
**é¢„è®¡ä¿®å¤æ—¶é—´**: 2-4å°æ—¶  
**ä¿®å¤åæ”¶ç›Š**: æå‡å®‰å…¨æ€§ã€æ”¹å–„å¼€å‘ä½“éªŒã€å‡å°‘æ„å»ºé”™è¯¯

**å»ºè®®ç«‹å³æ‰§è¡Œé«˜ä¼˜å…ˆçº§ä¿®å¤**ï¼Œå…¶ä»–é—®é¢˜å¯ä»¥æ ¹æ®å¼€å‘è¿›åº¦é€æ­¥ä¼˜åŒ–ã€‚
